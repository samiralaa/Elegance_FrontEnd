import{_ as R,M as T,y as k,D as z,r as l,a5 as J,o as f,c as w,a as g,t as i,e as t,q as a,m,E as c,a2 as L,g as O,j as D,a6 as A,a8 as U,a0 as j,a1 as q,b as h,X as _,a4 as x}from"./index-710d3685.js";const P={class:"categories-container"},W={class:"header"},X={class:"image-error"},Y={key:1,class:"image-error"},H={dir:"rtl"},K={dir:"rtl"},v="https://backend.webenia.org",Q={__name:"index",setup(Z){const b=T(),p=k([]),d=k(!1),C=`${v}/api/categories`,B=async()=>{d.value=!0;try{const e=JSON.parse(localStorage.getItem("tokenData"));if(!e||!e.token)throw new Error("Authentication token not found");h.defaults.headers.common.Authorization=`Bearer ${e.token}`;const r=await h.get(C);r.data.status===!0?p.value=r.data.data:_.error(r.data.message||"Failed to fetch categories")}catch(e){console.error("Fetch categories error:",e),e instanceof SyntaxError?_.error("Invalid token format"):_.error(e.message||"Failed to fetch categories")}finally{d.value=!1}},E=()=>{b.push("/categories/create")},N=e=>{b.push(`/categories/${e}`)},S=e=>{},I=async e=>{try{if(await x.confirm("Are you sure you want to delete this category?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"})==="confirm"){d.value=!0;const s=JSON.parse(localStorage.getItem("tokenData"));if(!s||!s.token)throw new Error("Authentication token not found");h.defaults.headers.common.Authorization=`Bearer ${s.token}`;const u=await h.delete(`${C}/${e.id}`);if(u.data.status==="success")_.success("Category deleted successfully"),p.value=p.value.filter(y=>y.id!==e.id);else throw new Error(u.data.message||"Failed to delete category")}}catch(r){r!=="cancel"&&(console.error("Delete category error:",r),_.error(r.message||"Failed to delete category"))}finally{d.value=!1}};return z(()=>{B()}),(e,r)=>{const s=l("el-button"),u=l("el-icon"),y=l("el-image"),n=l("el-table-column"),F=l("el-button-group"),M=l("el-table"),V=l("el-card"),G=J("loading");return f(),w("div",P,[g("div",W,[g("h2",null,i(e.$t("Categories.Categories")),1),t(s,{type:"primary",icon:c(L),onClick:E},{default:a(()=>[m(i(e.$t("Categories.AddCategory")),1)]),_:1},8,["icon"])]),t(V,{class:"categories-table"},{default:a(()=>[O((f(),D(M,{data:p.value,style:{width:"100%"}},{default:a(()=>[t(n,{label:e.$t("Categories.Image"),width:"120"},{default:a(({row:o})=>[o.images&&o.images.length>0?(f(),D(y,{key:0,src:`${v}/${o.images[0].path}`,fit:"cover",class:"category-image","preview-src-list":[`${v}/${o.images[0].path}`],"initial-index":0,"preview-teleported":""},{error:a(()=>[g("div",X,[t(u,null,{default:a(()=>[t(c(A))]),_:1})])]),_:2},1032,["src","preview-src-list"])):(f(),w("div",Y,[t(u,null,{default:a(()=>[t(c(A))]),_:1})]))]),_:1},8,["label"]),t(n,{prop:"name_en",label:e.$t("Categories.Categories")},null,8,["label"]),t(n,{prop:"name_ar",label:e.$t("Categories.name")},{default:a(({row:o})=>[g("div",H,i(o.name_ar||"N/A"),1)]),_:1},8,["label"]),t(n,{prop:"brand.name_en",label:e.$t("Categories.Brand")},null,8,["label"]),t(n,{prop:"description_en",label:e.$t("Categories.DescriptionEn")},null,8,["label"]),t(n,{prop:"description_ar",label:e.$t("Categories.DescriptionAr")},{default:a(({row:o})=>[g("div",K,i(o.description_ar||"N/A"),1)]),_:1},8,["label"]),t(n,{label:e.$t("Categories.Actions"),width:"200"},{default:a(({row:o})=>[t(F,null,{default:a(()=>[t(s,{type:"primary",icon:c(U),onClick:$=>N(o.id)},{default:a(()=>[m(i(e.$t("Global.View")),1)]),_:2},1032,["icon","onClick"]),t(s,{type:"warning",icon:c(j),onClick:$=>S(o)},{default:a(()=>[m(i(e.$t("Global.Edit")),1)]),_:2},1032,["icon","onClick"]),t(s,{type:"danger",icon:c(q),onClick:$=>I(o)},{default:a(()=>[m(i(e.$t("Global.Delete")),1)]),_:2},1032,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[G,d.value]])]),_:1})])}}},te=R(Q,[["__scopeId","data-v-85900c71"]]);export{te as default};
