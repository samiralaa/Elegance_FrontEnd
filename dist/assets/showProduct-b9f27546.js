import{_ as _e,z as me,G as pe,I as ge,J as he,x as fe,y as be,u as b,B as ke,K as ye,r as P,o as l,c as r,a,e as d,l as C,t as n,L as $,F as T,d as N,f as p,b as H,s as X,H as we,n as S,m as Ce,g as Fe,i as $e,w as Se,E as g}from"./index-8072a317.js";import{$ as k}from"./slick-theme-12a631b4.js";const Ie=["dir"],Te={class:"container"},xe={class:"product-details"},ze={class:"product-title"},qe=["innerHTML"],Ae={class:"price-block"},Ee={key:0,class:"price-old"},Pe={class:"price-new"},Ne={class:"product-actions"},Re=["title"],Me={key:0,class:"sale-badge"},Be={key:0,class:"weight"},Le={class:"weight-container"},Ve={class:"row g-4"},De=["onClick"],Oe={class:"buttons-section"},He={key:0,class:"quantity-section"},Qe={class:"quantity-control"},je=["src"],Ue={class:"slider-wrapper"},Je=["onClick"],Ge=["src"],Ke={key:0,class:"children-products-section"},We={class:"section-header"},Xe={class:"section-title"},Ye=["dir"],Ze={class:"container"},et={class:"products-grid"},tt={class:"image-container"},st=["src","alt"],at={key:0,class:"sale-badge"},ot={class:"product-actions"},it=["onClick"],nt=["onClick"],lt={class:"product-info"},rt={class:"prices"},ct={class:"price-new"},dt={key:0,class:"price-old"},ut={class:"addToCart-btn"},vt=["onClick","disabled"],_t={class:"row g-3"},mt={class:"product-card card border-0 h-100"},pt={class:"position-relative overflow-hidden bg-light"},gt=["src","alt"],ht={key:0,class:"sale-badge"},ft={class:"product-actions d-flex justify-content-center gap-2 w-100"},bt=["disabled"],kt=["disabled"],yt=["title"],wt={class:"card-body"},Ct={class:"card-title"},Ft={class:"price-container"},$t={key:0,class:"discount-badge"},St={key:1,class:"price-old"},It={class:"card-text card-price"},Y=1,Z=99,B="/default-image.jpg",Tt={__name:"showProduct",setup(xt){const{locale:y,t:c}=me(),Q=pe(()=>y.value==="ar"?"rtl":"ltr"),ee=ge(),te=he(),w=fe(),j=be(),t=b({}),h=b(1),R=b(null),F=b(!1);b(0);const I=b(null),x=b(null),L=b(3),V=b(3),z=e=>e?`https://backend.webenia.org/public/storage/${e}`:B,U=e=>{e.target.src=B},M=e=>{R.value=e,X(()=>{const s=document.querySelector(".main-image");s&&(s.src=z(e))})},se=async()=>{var e;try{const s=await H.get(`https://backend.webenia.org/api/website/show/products/${ee.params.id}`);s.data.status&&(t.value=s.data.data,(e=t.value.images)!=null&&e.length&&(R.value=t.value.images[0].path,X(()=>{J(),ve()})))}catch(s){console.error("Error fetching product:",s)}},D=async()=>{var e,s;try{const i={product_id:t.value.id,quantity:h.value,price:t.value.price};t.value.amounts&&(i.amount_id=t.value.amount_id);const m=await H.post("https://backend.webenia.org/api/cart-items",i,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});m.data.message&&(g({title:c("success"),message:m.data.message,type:"success"}),j.incrementCount(),await j.fetchCartCount())}catch(i){g({title:"❌",message:((s=(e=i.response)==null?void 0:e.data)==null?void 0:s.message)||c("add_to_cart_error")||"Login required to add to cart",type:"error"})}},ae=e=>{te.push(`${e}`)},oe=async e=>{var s,i,m;try{const u={product_id:e.id,quantity:1,price:e.price},f=(s=JSON.parse(localStorage.getItem("auth_user")))==null?void 0:s.id;f&&(u.user_id=f),e.amounts&&(u.amount_id=e.amount_id);const q=await H.post("https://backend.webenia.org/api/cart-items",u,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});q.data.message&&g({title:c("success"),message:q.data.message,type:"success"})}catch(u){console.error("Error adding child product to cart:",u),g({title:"❌",message:((m=(i=u.response)==null?void 0:i.data)==null?void 0:m.message)||c("add_to_cart_error")||"Login required to add to cart",type:"error"})}},O=b(),ie=(e,s)=>{O.value=e,t.value.amount_id=s.id,t.value.price=s.price},ne=()=>{O.value=null,t.value.amount_id=null,t.value.original_price},J=()=>{var m;const e=k(I.value),s=k(x.value);e.hasClass("slick-initialized")&&e.slick("unslick"),s.hasClass("slick-initialized")&&s.slick("unslick");const i=((m=t.value.images)==null?void 0:m.length)||0;V.value=i,L.value=i>=4?3:1,e.slick({dots:i>1,centerMode:!0,centerPadding:"0px",slidesToShow:L.value,slidesToScroll:1,infinite:i>1,focusOnSelect:!0,rtl:y.value==="ar",asNavFor:s,afterChange:function(u){const f=t.value.images[u];f&&M(f.path)}}),s.slick({slidesToShow:1,slidesToScroll:1,infinite:i>1,fade:!0,arrows:!1,dots:!1,centerMode:!0,rtl:y.value==="ar",asNavFor:e,afterChange:function(u){const f=t.value.images[u];f&&M(f.path)}})},le=()=>{const e=k(I.value),s=k(x.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickPrev"),s.slick("slickPrev"),G())},re=()=>{const e=k(I.value),s=k(x.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickNext"),s.slick("slickNext"),G())},G=()=>{const e=k(I.value);if(e.length&&e.hasClass("slick-initialized")){const i=e.find(".slick-current").find("img").attr("src").replace("https://backend.webenia.org/public/storage/","");M(i)}};ke(()=>{se().then(J)}),ye(()=>{const e=k(x.value),s=k(I.value);e.hasClass("slick-initialized")&&e.slick("unslick"),s.hasClass("slick-initialized")&&s.slick("unslick")});const K=e=>w.isInFavorites(e.id),ce=async e=>{try{if(K(e)){const s=w.favorites.find(i=>i.product_id===e.id);s&&(await w.removeFromFavorites(s.id),g({title:c("Removed From Favorites"),message:c("Product Removed From Favorites"),type:"success"}))}else await w.addToFavorites(e.id)&&g({title:c("Added To Favorites"),message:c("Product Added To Favorites"),type:"success"})}catch(s){console.error("Error toggling child favorites:",s),g({title:c("error"),message:s.message||c("failed_to_toggle_favorite"),type:"error"})}},de=()=>{h.value<Z?h.value++:g({title:c("warning"),message:c("max_quantity_reached"),type:"warning"})},ue=()=>{h.value>Y?h.value--:g({title:c("warning"),message:c("min_quantity_reached"),type:"warning"})},W=async()=>{try{if(F.value){const e=w.favorites.find(s=>s.product_id===t.value.id);e&&(await w.removeFromFavorites(e.id),F.value=!1,g({title:c("Removed From Favorites"),message:c("Product Removed From Favorites"),type:"success"}))}else await w.addToFavorites(t.value.id)&&(F.value=!0,g({title:c("Added To Favorites"),message:c("Product Added To Favorites"),type:"success"}))}catch(e){console.error("Error toggling favorites:",e),g({title:c("error"),message:e.message||c("failed_to_toggle_favorite"),type:"error"})}},ve=()=>{F.value=w.isInFavorites(t.value.id)};return(e,s)=>{const i=P("fa"),m=P("el-button"),u=P("el-col"),f=P("el-row"),q=P("router-link");return l(),r(T,null,[s[8]||(s[8]=a("link",{href:"https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap",rel:"stylesheet"},null,-1)),d(we),a("div",{class:"product-show",dir:Q.value},[a("div",Te,[d(f,{gutter:20,class:"product-container full-height-row flex-md-row flex-column-reverse"},{default:C(()=>[d(u,{xs:24,sm:24,md:12,lg:14},{default:C(()=>{var o,v;return[a("div",xe,[a("h1",ze,n($(y)==="ar"?t.value.name_ar:t.value.name_en),1),a("div",{innerHTML:$(y)==="ar"?t.value.description_ar:t.value.description_en,class:"description"},null,8,qe),a("div",Ae,[t.value.old_price?(l(),r("span",Ee,n(t.value.old_price)+" "+n((o=t.value.currency)==null?void 0:o.name_en),1)):p("",!0),a("span",Pe,n(t.value.price)+" "+n((v=t.value.currency)==null?void 0:v.name_en),1)]),a("div",Ne,[a("button",{onClick:s[0]||(s[0]=_=>W(t.value)),class:S(["btn rounded-circle shadow-sm btn-light",F.value?"text-danger":""]),title:F.value?"Remove from favorites":"Add to favorites"},[d(i,{icon:F.value?"fas fa-heart":"far fa-heart",size:"xl"},null,8,["icon"])],10,Re),t.value.is_available?p("",!0):(l(),r("div",Me,n(e.$t("products.outOfStock")),1))]),t.value.amounts&&t.value.amounts.length>0?(l(),r("div",Be,[s[7]||(s[7]=a("h1",{class:"weight-title"},"Select Weight",-1)),a("div",{class:"reset",onClick:ne},[d(i,{icon:"rotate-right"}),s[6]||(s[6]=a("a",null,"reset",-1))]),a("div",Le,[a("div",Ve,[(l(!0),r(T,null,N(t.value.amounts,(_,A)=>{var E;return l(),r("div",{key:_.id,class:S(["weight-item",{active:O.value===A}]),onClick:zt=>ie(A,_)},[a("p",null,n(_.weight)+" "+n(_.unit.name_en)+" For "+n(_.price)+" "+n((E=t.value.currency)==null?void 0:E.name_en),1)],10,De)}),128))])])])):p("",!0),a("div",Oe,[d(m,{class:"add-to-cart btn",disabled:!t.value.is_available,type:"primary",size:"large",round:"",onClick:D},{default:C(()=>[Ce(n(e.$t("products.addToCart")),1)]),_:1},8,["disabled"]),t.value.is_available?(l(),r("div",He,[a("div",Qe,[d(m,{size:"small",onClick:ue,disabled:h.value<=Y,class:"qty-btn"},{default:C(()=>[d(i,{icon:"minus"})]),_:1},8,["disabled"]),Fe(a("input",{class:"qty-number",type:"number",min:"1",max:"99","onUpdate:modelValue":s[1]||(s[1]=_=>h.value=_),onInput:s[2]||(s[2]=_=>h.value=Math.min(h.value))},null,544),[[$e,h.value,void 0,{number:!0}]]),d(m,{size:"small",onClick:de,disabled:h.value>=Z,class:"qty-btn"},{default:C(()=>[d(i,{icon:"plus"})]),_:1},8,["disabled"])])])):p("",!0)])])]}),_:1}),d(u,{xs:24,sm:24,md:12,lg:10,class:"image-col"},{default:C(()=>[a("div",{class:"image-wrapper",ref_key:"main",ref:x},[(l(!0),r(T,null,N(t.value.images,(o,v)=>(l(),r("div",{key:o.id,class:"slide"},[a("img",{src:z(R.value),class:"main-image",onError:U},null,40,je)]))),128))],512),a("div",Ue,[V.value>1?(l(),r("button",{key:0,class:"btn nav-button left",onClick:le},[d(i,{icon:"arrow-left"})])):p("",!0),a("div",{class:S(["slider-container",{"centered-slides":L.value<3}])},[a("div",{class:"slider",ref_key:"slider",ref:I},[(l(!0),r(T,null,N(t.value.images,(o,v)=>(l(),r("div",{key:o.id,class:"slide",onClick:_=>M(o.path)},[a("img",{src:z(o.path),class:S({active:R.value===o.path}),onError:U},null,42,Ge)],8,Je))),128))],512)],2),V.value>1?(l(),r("button",{key:1,class:"btn nav-button right",onClick:re},[d(i,{icon:"arrow-right"})])):p("",!0)])]),_:1})]),_:1}),t.value.children&&t.value.children.length>0?(l(),r("div",Ke,[a("div",We,[a("h2",Xe,n($(c)("related_products")),1)]),a("div",{class:"shop-container",dir:Q.value},[a("div",Ze,[a("section",et,[(l(!0),r(T,null,N(t.value.children,o=>{var v,_,A;return l(),r("div",{key:o.id,class:"product-card"},[a("div",tt,[a("img",{src:(v=o.images)!=null&&v.length?z(o.images[0].path):B,alt:$(y)==="ar"?o.name_ar:o.name_en},null,8,st),o.old_price?(l(),r("div",at,"Sale")):p("",!0),a("div",ot,[a("button",{onClick:E=>ae(o.id),class:"action-btn cart-btn"},[d(i,{icon:"eye"})],8,it),a("button",{onClick:E=>ce(o),class:"action-btn love-btn"},[d(i,{icon:K(o)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],8,nt)])]),a("div",lt,[a("h4",null,n($(y)==="ar"?o.name_ar:o.name_en),1),a("div",rt,[a("span",ct,n(o.price)+" "+n(((_=o.currency)==null?void 0:_.name_en)||"AED"),1),o.old_price?(l(),r("span",dt,n(o.old_price)+" "+n(((A=o.currency)==null?void 0:A.name_en)||"AED"),1)):p("",!0)]),a("div",ut,[a("button",{onClick:Se(E=>oe(o),["stop"]),disabled:!o.is_available,class:"btn"},n($(c)("products.addToCart")),9,vt)])])])}),128))])])],8,Ye)])):p("",!0),a("div",_t,[(l(!0),r(T,null,N(t.value.children,o=>(l(),r("div",{class:"col-6 col-md-4 col-lg-3",key:o.id},[a("div",mt,[a("div",pt,[d(q,{to:`/read/products/${t.value.id}`},{default:C(()=>{var v;return[a("img",{src:(v=o.images)!=null&&v.length?z(o.images[0].path):B,alt:$(y)==="ar"?o.name_ar:o.name_en,class:"card-img-top product-img"},null,8,gt)]}),_:2},1032,["to"]),t.value.is_available?p("",!0):(l(),r("div",ht,n(e.$t("products.outOfStock")),1)),a("div",ft,[d(q,{to:`/read/products/${t.value.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:C(()=>[d(i,{icon:"eye"})]),_:1},8,["to"]),a("button",{onClick:s[3]||(s[3]=v=>D(t.value)),class:S(["btn btn-light shadow-sm",{disabled:!t.value.is_available}]),disabled:!t.value.is_available},n(e.$t("home.add-to-cart")),11,bt),a("button",{onClick:s[4]||(s[4]=v=>D(t.value)),class:S(["d-none btn rounded-circle btn-light shadow-sm",{disabled:!t.value.is_available}]),disabled:!t.value.is_available},[d(i,{icon:"cart-plus"})],10,kt),a("button",{onClick:s[5]||(s[5]=v=>W(t.value)),class:S(["btn rounded-circle shadow-sm btn-light",e.isInFavorites(t.value.id)?"text-danger":""]),title:e.isInFavorites(t.value.id)?"Remove from favorites":"Add to favorites"},[d(i,{icon:e.isInFavorites(t.value.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,yt)])]),a("div",wt,[a("h5",Ct,n(t.value.name_en),1),a("div",Ft,[t.value.discount&&t.value.discount.length>0?(l(),r("span",$t," -"+n(t.value.discount[0].discount_value),1)):p("",!0),t.value.discount&&t.value.discount.length>0?(l(),r("span",St,n(t.value.price)+" "+n(t.value.currency.name_en),1)):p("",!0),a("span",It,n(e.calculateDiscountedPrice(t.value))+" "+n(t.value.currency.name_en),1)])])])]))),128))])])],8,Ie)],64)}}},Et=_e(Tt,[["__scopeId","data-v-72ecc3b2"]]);export{Et as default};
