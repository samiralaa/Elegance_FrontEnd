import{_ as X,L as Y,y as _,J as j,D as H,r as s,o as i,c as g,e as o,q as r,b as m,X as y,a as v,t as b,F as P,d as V,k as $,f as K}from"./index-44f336bc.js";const Q={class:"product-create-container"},W={class:"currency-option"},Z={class:"currency-name"},x={class:"currency-rate"},ee={class:"el-upload__text"},h="https://backend.webenia.org",ae={__name:"create",setup(le){const R=Y(),k=_(null),l=_({name_en:"",name_ar:"",price:"",is_available:1,description_en:"",description_ar:"",category_id:null,currency_id:null,country_id:null,parent_id:null}),U={name_en:[{required:!0,message:"Please input product name (EN)",trigger:"blur"}],price:[{required:!0,message:"Please input product price",trigger:"blur"}],category_id:[{required:!0,message:"Please select a category",trigger:"change"}],currency_id:[{required:!0,message:"Please select a currency",trigger:"change"}],country_id:[{required:!0,message:"Please select a country",trigger:"change"}]},f=_([]),C=_([]),w=_([]),E=_([]),S=_([]),A=`${h}/api/products`,D=`${h}/api/categories`,F=`${h}/api/currencies`,I=`${h}/api/countries`,N=j(()=>w.value.filter(t=>!t.is_deleted)),B=t=>(localStorage.getItem("lang")||"en")==="ar"?t.name_ar:t.name_en,q=async()=>{var t,e;try{const u=JSON.parse(localStorage.getItem("tokenData"));if(!u||!u.token)throw new Error("Authentication token not found");m.defaults.headers.common.Authorization=`Bearer ${u.token}`;const n=await m.get(D);n.data.status&&n.data.data&&(C.value=n.data.data);const p=await m.get(F);p.data&&Array.isArray(p.data)&&(w.value=p.data);const d=await m.get(I);d.data.status&&d.data.data&&(E.value=d.data.data);const c=await m.get(A);c.data.status&&c.data.data&&(S.value=c.data.data)}catch(u){console.error("Error fetching select options:",u),y.error(((e=(t=u.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to load form options")}},O=(t,e)=>{f.value=e},L=(t,e)=>{f.value=e},T=()=>{k.value.validate(async t=>{if(t)try{const e=new FormData;if(e.append("name_en",l.value.name_en),e.append("name_ar",l.value.name_ar),e.append("price",l.value.price),e.append("is_available",l.value.is_available),e.append("description_en",l.value.description_en),e.append("description_ar",l.value.description_ar),e.append("category_id",l.value.category_id),e.append("currency_id",l.value.currency_id),e.append("country_id",l.value.country_id),l.value.parent_id&&e.append("parent_id",l.value.parent_id),f.value.forEach(p=>{e.append("images[]",p.raw)}),f.value.length>3){y.warning("You can only upload up to 3 images.");return}const u=JSON.parse(localStorage.getItem("tokenData"));if(!u||!u.token)throw new Error("Authentication token not found");m.defaults.headers.common.Authorization=`Bearer ${u.token}`;const n=await m.post(A,e,{headers:{"Content-Type":"multipart/form-data"}});if(n.data.status)y.success("Product created successfully"),R.push("/products");else throw new Error(n.data.message||"Failed to create product")}catch(e){console.error("Product creation error:",e),y.error(e.message||"Failed to create product")}else return console.log("Form validation failed"),!1})};return H(()=>{q()}),(t,e)=>{const u=s("el-input"),n=s("el-form-item"),p=s("el-switch"),d=s("el-option"),c=s("el-select"),J=s("el-upload"),z=s("el-button"),M=s("el-form"),G=s("el-card");return i(),g("div",Q,[o(G,{class:"product-card"},{default:r(()=>[v("h2",null,b(t.$t("Products.CreateProduct")),1),o(M,{model:l.value,ref_key:"formRef",ref:k,rules:U,"label-width":"120px",enctype:"multipart/form-data"},{default:r(()=>[o(n,{label:t.$t("Products.NameEn"),prop:"name_en"},{default:r(()=>[o(u,{modelValue:l.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.name_en=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.NameAr"),prop:"name_ar"},{default:r(()=>[o(u,{modelValue:l.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.name_ar=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Price"),prop:"price"},{default:r(()=>[o(u,{modelValue:l.value.price,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.price=a),type:"number"},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Availability"),prop:"is_available"},{default:r(()=>[o(p,{modelValue:l.value.is_available,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.is_available=a),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.DescriptionEn"),prop:"description_en"},{default:r(()=>[o(u,{type:"textarea",modelValue:l.value.description_en,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.description_en=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.DescriptionAr"),prop:"description_ar"},{default:r(()=>[o(u,{type:"textarea",modelValue:l.value.description_ar,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.description_ar=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Category"),prop:"category_id"},{default:r(()=>[o(c,{modelValue:l.value.category_id,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.category_id=a),placeholder:t.$t("Products.SelectCategory"),filterable:"",clearable:""},{default:r(()=>[(i(!0),g(P,null,V(C.value,a=>(i(),$(d,{key:a.id,label:a.name_en||a.name_ar,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Currency"),prop:"currency_id"},{default:r(()=>[o(c,{modelValue:l.value.currency_id,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.currency_id=a),placeholder:t.$t("Products.SelectCurrency"),filterable:"",clearable:""},{default:r(()=>[(i(!0),g(P,null,V(N.value,a=>(i(),$(d,{key:a.id,label:B(a),value:a.id},{default:r(()=>[v("div",W,[v("span",Z,b(a.name_en),1),v("span",x,"("+b(parseFloat(a.exchange_rate).toFixed(2))+")",1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Country"),prop:"country_id"},{default:r(()=>[o(c,{modelValue:l.value.country_id,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.country_id=a),placeholder:t.$t("Products.SelectCountry"),filterable:"",clearable:""},{default:r(()=>[(i(!0),g(P,null,V(E.value,a=>(i(),$(d,{key:a.id,label:a.name_en||a.name_ar,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.ParentProduct"),prop:"parent_id"},{default:r(()=>[o(c,{modelValue:l.value.parent_id,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.parent_id=a),placeholder:t.$t("Products.SelectParentProduct"),clearable:""},{default:r(()=>[o(d,{label:t.$t("Products.None"),value:null},null,8,["label"]),(i(!0),g(P,null,V(S.value,a=>(i(),$(d,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(n,{label:t.$t("Products.Images"),prop:"images"},{default:r(()=>[o(J,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:5,"file-list":f.value,"list-type":"picture","on-change":O,"on-remove":L},{default:r(()=>[e[10]||(e[10]=v("i",{class:"el-icon-upload"},null,-1)),v("div",ee,b(t.$t("Products.DropFiles")),1)]),_:1,__:[10]},8,["file-list"])]),_:1},8,["label"]),o(n,null,{default:r(()=>[o(z,{type:"primary",onClick:T},{default:r(()=>[K(b(t.$t("Products.CreateButton")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},oe=X(ae,[["__scopeId","data-v-18ab885b"]]);export{oe as default};
