import{_ as f,H as v,b as _,r as b,o as d,c as a,e as y,a as t,w as c,t as n,F as m,d as p,n as O}from"./index-23e6863a.js";const C={components:{Header:v},name:"UserOrder",data(){return{loading:!0,orders:[],currentFilter:null}},computed:{pendingOrdersCount(){return this.orders.filter(s=>s.status==="pending").length},shippedOrdersCount(){return this.orders.filter(s=>s.status==="shipped").length},completedOrdersCount(){return this.orders.filter(s=>s.status==="completed"||s.status==="delivered").length},cancelledOrdersCount(){return this.orders.filter(s=>s.status==="cancelled").length},filteredOrders(){return this.currentFilter?this.orders.filter(s=>this.currentFilter==="completed"?s.status==="completed"||s.status==="delivered":s.status===this.currentFilter):this.orders}},methods:{async fetchOrders(){var s,e,g;try{const o=localStorage.getItem("auth_token");if(!o){this.$toast.error("Please login to view your orders"),this.$router.push("/login");return}const i=await _.get("http://elegance_backend.test/api/orders/user",{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});i.data.status&&i.data.data.original.success?this.orders=i.data.data.original.orders:this.$toast.error(i.data.message||"Failed to fetch orders")}catch(o){console.error("Failed to fetch orders:",o),((s=o.response)==null?void 0:s.status)===401?(this.$toast.error("Please login to view your orders"),this.$router.push("/login")):this.$toast.error(((g=(e=o.response)==null?void 0:e.data)==null?void 0:g.message)||"Failed to fetch orders")}finally{this.loading=!1}},filterOrders(s){this.currentFilter=this.currentFilter===s?null:s},imageUrl(s){return`http://elegance_backend.test/public/storage/${s}`},formatDate(s){return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0})},formatStatus(s){return{pending:"In Progress",processing:"Processing",shipped:"On Delivery",delivered:"Delivered",completed:"Completed",cancelled:"Cancelled"}[s.toLowerCase()]||s},getStatusBadgeClass(s){return{pending:"bg-warning",processing:"bg-info",shipped:"bg-primary",delivered:"bg-success",completed:"bg-success",cancelled:"bg-danger"}[s.toLowerCase()]||"bg-secondary"}},mounted(){this.fetchOrders()}},w={class:"container py-4"},x={class:"orders-header"},k={class:"num"},F={class:"num"},D={class:"num"},S={class:"num"},P={key:0,class:"text-center"},B={key:1,class:"row g-4"},I={class:"order-card p-4 rounded-4 shadow-sm bg-white"},j={class:"d-flex justify-content-between align-items-start flex-wrap mb-3"},z={class:"fw-bold"},E={class:"text-end"},H={class:"text-muted"},L={class:"items row gy-3 overflow-auto mb-3 pb-2 border-bottom"},M=["src"],U={class:"small"},N={class:"text-muted"},G={class:"text-muted"},T={class:"d-flex justify-content-between align-items-center"},V={key:2,class:"alert alert-info text-center"};function q(s,e,g,o,i,r){const h=b("Header");return d(),a(m,null,[y(h),t("div",w,[e[14]||(e[14]=t("h2",{class:"mb-4 fw-bold"},"My Orders",-1)),t("div",x,[t("a",{class:"order-stage",href:"#",onClick:e[0]||(e[0]=c(l=>r.filterOrders("pending"),["prevent"]))},[e[4]||(e[4]=t("h3",null,"In Progress",-1)),t("h3",k,n(r.pendingOrdersCount),1)]),t("a",{class:"order-stage",href:"#",onClick:e[1]||(e[1]=c(l=>r.filterOrders("shipped"),["prevent"]))},[e[5]||(e[5]=t("h3",null,"On Shipping",-1)),t("h3",F,n(r.shippedOrdersCount),1)]),t("a",{class:"order-stage",href:"#",onClick:e[2]||(e[2]=c(l=>r.filterOrders("completed"),["prevent"]))},[e[6]||(e[6]=t("h3",null,"Delivered",-1)),t("h3",D,n(r.completedOrdersCount),1)]),t("a",{class:"order-stage",href:"#",onClick:e[3]||(e[3]=c(l=>r.filterOrders("cancelled"),["prevent"]))},[e[7]||(e[7]=t("h3",null,"Cancelled",-1)),t("h3",S,n(r.cancelledOrdersCount),1)])]),i.loading?(d(),a("div",P,e[8]||(e[8]=[t("div",{class:"spinner-border",role:"status"},null,-1)]))):r.filteredOrders.length>0?(d(),a("div",B,[(d(!0),a(m,null,p(r.filteredOrders,l=>(d(),a("div",{key:l.id,class:"col-12 col-md-6"},[t("div",I,[t("div",j,[t("div",null,[e[9]||(e[9]=t("small",{class:"text-muted"},"Order ID",-1)),t("h5",z,"#"+n(l.id),1)]),t("div",E,[t("small",H,n(r.formatDate(l.ordered_at)),1),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=t("small",{class:"text-muted"},"Estimated arrival:",-1)),e[12]||(e[12]=t("br",null,null,-1)),t("span",{class:O(["badge",r.getStatusBadgeClass(l.status)])},n(r.formatStatus(l.status)),3)])]),t("div",L,[(d(!0),a(m,null,p(l.items,u=>(d(),a("div",{key:u.id,class:"d-flex flex-column align-items-start col-4"},[t("img",{src:r.imageUrl(u.product.images[0].path),class:"rounded mb-2",style:{width:"100%","aspect-ratio":"1","object-fit":"cover"}},null,8,M),t("strong",U,n(u.product.name_en),1),t("small",N,n(u.price)+" EGP x"+n(u.quantity),1),t("small",G,"Size: "+n(u.size||"-"),1)]))),128))]),t("div",T,[t("strong",null,"Total: "+n(l.total_price)+" EGP ("+n(l.items.length)+" Items)",1),e[13]||(e[13]=t("button",{class:"btn btn-outline-dark btn-sm"},"Details",-1))])])]))),128))])):(d(),a("div",V," No orders found. "))])],64)}const $=f(C,[["render",q],["__scopeId","data-v-102e7e54"]]);export{$ as default};
