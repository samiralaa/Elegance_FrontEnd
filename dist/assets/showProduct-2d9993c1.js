import{_ as _e,D as ve,G as me,I as pe,J as ge,x as he,y as fe,u as p,z as ke,K as ye,r as N,o as c,c as l,a as s,e as d,l as S,t as r,L as T,F as z,d as P,f as y,b as D,s as G,H as be,n as L,m as we,w as Ce,E as v}from"./index-4ca6c910.js";import{$ as h}from"./slick-theme-80e0815b.js";const Fe=["dir"],Se={class:"container"},Te={class:"product-details"},$e={class:"product-title"},Ie=["innerHTML"],xe={class:"price-block"},ze={key:0,class:"price-old"},qe={class:"price-new"},Ee={class:"product-actions"},Ae={key:0,class:"weight"},Ne={class:"weight-container"},Pe={class:"row g-4"},Le=["onClick"],Re={class:"buttons-section"},Be={class:"quantity-section"},Me={class:"quantity-control"},De={class:"qty-number"},He=["src"],Qe={key:0,class:"sale-badge"},Ve={class:"slider-wrapper"},Oe=["onClick"],je=["src"],Je={key:0,class:"children-products-section"},Ue={class:"section-header"},Ge={class:"section-title"},Ke=["dir"],We={class:"container"},Xe={class:"products-grid"},Ye={class:"image-container"},Ze=["src","alt"],et={key:0,class:"sale-badge"},tt={class:"product-actions"},st=["onClick"],at=["onClick"],ot={class:"product-info"},it={class:"prices"},nt={class:"price-new"},rt={key:0,class:"price-old"},ct={class:"addToCart-btn"},lt=["onClick","disabled"],K=1,W=99,H="/default-image.jpg",dt={__name:"showProduct",setup(ut){const{locale:b,t:n}=ve(),Q=me(()=>b.value==="ar"?"rtl":"ltr"),X=pe(),Y=ge(),f=he(),V=fe(),a=p({}),k=p(1),q=p(null),C=p(!1);p(0);const F=p(null),$=p(null),R=p(3),B=p(3),E=e=>e?`https://backend.webenia.org/public/storage/${e}`:H,O=e=>{e.target.src=H},A=e=>{q.value=e,G(()=>{const t=document.querySelector(".main-image");t&&(t.src=E(e))})},Z=async()=>{var e;try{const t=await D.get(`https://backend.webenia.org/api/website/show/products/${X.params.id}`);t.data.status&&(a.value=t.data.data,(e=a.value.images)!=null&&e.length&&(q.value=a.value.images[0].path,G(()=>{j(),ue()})))}catch(t){console.error("Error fetching product:",t)}},ee=async()=>{var e,t;try{const i={product_id:a.value.id,quantity:k.value,price:a.value.price};a.value.amounts&&(i.amount_id=a.value.amount_id);const _=await D.post("https://backend.webenia.org/api/cart-items",i,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});_.data.message&&(v({title:n("success"),message:_.data.message,type:"success"}),V.incrementCount(),await V.fetchCartCount())}catch(i){v({title:"❌",message:((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||n("add_to_cart_error")||"Login required to add to cart",type:"error"})}},te=e=>{Y.push(`/products/${e}`)},se=async e=>{var t,i,_;try{const u={product_id:e.id,quantity:1,price:e.price},m=(t=JSON.parse(localStorage.getItem("auth_user")))==null?void 0:t.id;m&&(u.user_id=m),e.amounts&&(u.amount_id=e.amount_id);const o=await D.post("https://backend.webenia.org/api/cart-items",u,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});o.data.message&&v({title:n("success"),message:o.data.message,type:"success"})}catch(u){console.error("Error adding child product to cart:",u),v({title:"❌",message:((_=(i=u.response)==null?void 0:i.data)==null?void 0:_.message)||n("add_to_cart_error")||"Login required to add to cart",type:"error"})}},M=p(),ae=(e,t)=>{M.value=e,a.value.amount_id=t.id,a.value.price=t.price},oe=()=>{M.value=null,a.value.amount_id=null,a.value.original_price},j=()=>{var _;const e=h(F.value),t=h($.value);e.hasClass("slick-initialized")&&e.slick("unslick"),t.hasClass("slick-initialized")&&t.slick("unslick");const i=((_=a.value.images)==null?void 0:_.length)||0;B.value=i,R.value=i>=4?3:1,e.slick({dots:i>1,centerMode:!0,centerPadding:"0px",slidesToShow:R.value,slidesToScroll:1,infinite:i>1,focusOnSelect:!0,rtl:b.value==="ar",asNavFor:t,afterChange:function(u){const m=a.value.images[u];m&&A(m.path)}}),t.slick({slidesToShow:1,slidesToScroll:1,infinite:i>1,fade:!0,arrows:!1,dots:!1,centerMode:!0,rtl:b.value==="ar",asNavFor:e,afterChange:function(u){const m=a.value.images[u];m&&A(m.path)}})},ie=()=>{const e=h(F.value),t=h($.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickPrev"),t.slick("slickPrev"),J())},ne=()=>{const e=h(F.value),t=h($.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickNext"),t.slick("slickNext"),J())},J=()=>{const e=h(F.value);if(e.length&&e.hasClass("slick-initialized")){const i=e.find(".slick-current").find("img").attr("src").replace("https://backend.webenia.org/public/storage/","");A(i)}};ke(()=>{Z().then(j)}),ye(()=>{const e=h($.value),t=h(F.value);e.hasClass("slick-initialized")&&e.slick("unslick"),t.hasClass("slick-initialized")&&t.slick("unslick")});const U=e=>f.isInFavorites(e.id),re=async e=>{try{if(U(e)){const t=f.favorites.find(i=>i.product_id===e.id);t&&(await f.removeFromFavorites(t.id),v({title:n("Removed From Favorites"),message:n("Product Removed From Favorites"),type:"success"}))}else await f.addToFavorites(e.id)&&v({title:n("Added To Favorites"),message:n("Product Added To Favorites"),type:"success"})}catch(t){console.error("Error toggling child favorites:",t),v({title:n("error"),message:t.message||n("failed_to_toggle_favorite"),type:"error"})}},ce=()=>{k.value<W?k.value++:v({title:n("warning"),message:n("max_quantity_reached"),type:"warning"})},le=()=>{k.value>K?k.value--:v({title:n("warning"),message:n("min_quantity_reached"),type:"warning"})},de=async()=>{try{if(C.value){const e=f.favorites.find(t=>t.product_id===a.value.id);e&&(await f.removeFromFavorites(e.id),C.value=!1,v({title:n("Removed From Favorites"),message:n("Product Removed From Favorites"),type:"success"}))}else await f.addToFavorites(a.value.id)&&(C.value=!0,v({title:n("Added To Favorites"),message:n("Product Added To Favorites"),type:"success"}))}catch(e){console.error("Error toggling favorites:",e),v({title:n("error"),message:e.message||n("failed_to_toggle_favorite"),type:"error"})}},ue=()=>{C.value=f.isInFavorites(a.value.id)};return(e,t)=>{const i=N("fa"),_=N("el-button"),u=N("el-col"),m=N("el-row");return c(),l(z,null,[t[2]||(t[2]=s("link",{href:"https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap",rel:"stylesheet"},null,-1)),d(be),s("div",{class:"product-show",dir:Q.value},[s("div",Se,[d(m,{gutter:20,class:"product-container full-height-row flex-md-row flex-column-reverse"},{default:S(()=>[d(u,{xs:24,sm:24,md:12,lg:14},{default:S(()=>{var o,w;return[s("div",Te,[s("h1",$e,r(T(b)==="ar"?a.value.name_ar:a.value.name_en),1),s("div",{innerHTML:T(b)==="ar"?a.value.description_ar:a.value.description_en,class:"description"},null,8,Ie),s("div",xe,[a.value.old_price?(c(),l("span",ze,r(a.value.old_price)+" "+r((o=a.value.currency)==null?void 0:o.name_en),1)):y("",!0),s("span",qe,r(a.value.price)+" "+r((w=a.value.currency)==null?void 0:w.name_en),1)]),s("div",Ee,[s("button",{onClick:de,class:L(["action-btn love-btn",{active:C.value}])},[d(i,{icon:C.value?"fas fa-heart":"far fa-heart"},null,8,["icon"])],2)]),a.value.amounts&&a.value.amounts.length>0?(c(),l("div",Ae,[t[1]||(t[1]=s("h1",{class:"weight-title"},"Select Weight",-1)),s("div",{class:"reset",onClick:oe},[d(i,{icon:"rotate-right"}),t[0]||(t[0]=s("a",null,"reset",-1))]),s("div",Ne,[s("div",Pe,[(c(!0),l(z,null,P(a.value.amounts,(g,I)=>{var x;return c(),l("div",{key:g.id,class:L(["weight-item",{active:M.value===I}]),onClick:_t=>ae(I,g)},[s("p",null,r(g.weight)+" "+r(g.unit.name_en)+" For "+r(g.price)+" "+r((x=a.value.currency)==null?void 0:x.name_en),1)],10,Le)}),128))])])])):y("",!0),s("div",Re,[d(_,{class:"add-to-cart",type:"primary",size:"large",round:"",onClick:ee},{default:S(()=>[we(r(e.$t("add_to_cart")),1)]),_:1}),s("div",Be,[s("div",Me,[d(_,{size:"small",onClick:le,disabled:k.value<=K,class:"qty-btn"},{default:S(()=>[d(i,{icon:"minus"})]),_:1},8,["disabled"]),s("span",De,r(k.value),1),d(_,{size:"small",onClick:ce,disabled:k.value>=W,class:"qty-btn"},{default:S(()=>[d(i,{icon:"plus"})]),_:1},8,["disabled"])])])])])]}),_:1}),d(u,{xs:24,sm:24,md:12,lg:10,class:"image-col"},{default:S(()=>[s("div",{class:"image-wrapper",ref_key:"main",ref:$},[(c(!0),l(z,null,P(a.value.images,(o,w)=>(c(),l("div",{key:o.id,class:"slide"},[s("img",{src:E(q.value),class:"main-image",onError:O},null,40,He)]))),128)),a.value.old_price?(c(),l("div",Qe,"Sale")):y("",!0)],512),s("div",Ve,[B.value>1?(c(),l("button",{key:0,class:"btn nav-button left",onClick:ie},[d(i,{icon:"arrow-left"})])):y("",!0),s("div",{class:L(["slider-container",{"centered-slides":R.value<3}])},[s("div",{class:"slider",ref_key:"slider",ref:F},[(c(!0),l(z,null,P(a.value.images,(o,w)=>(c(),l("div",{key:o.id,class:"slide",onClick:g=>A(o.path)},[s("img",{src:E(o.path),class:L({active:q.value===o.path}),onError:O},null,42,je)],8,Oe))),128))],512)],2),B.value>1?(c(),l("button",{key:1,class:"btn nav-button right",onClick:ne},[d(i,{icon:"arrow-right"})])):y("",!0)])]),_:1})]),_:1}),a.value.children&&a.value.children.length>0?(c(),l("div",Je,[s("div",Ue,[s("h2",Ge,r(T(n)("related_products")),1)]),s("div",{class:"shop-container",dir:Q.value},[s("div",We,[s("section",Xe,[(c(!0),l(z,null,P(a.value.children,o=>{var w,g,I;return c(),l("div",{key:o.id,class:"product-card"},[s("div",Ye,[s("img",{src:(w=o.images)!=null&&w.length?E(o.images[0].path):H,alt:T(b)==="ar"?o.name_ar:o.name_en},null,8,Ze),o.old_price?(c(),l("div",et,"Sale")):y("",!0),s("div",tt,[s("button",{onClick:x=>te(o.id),class:"action-btn cart-btn"},[d(i,{icon:"eye"})],8,st),s("button",{onClick:x=>re(o),class:"action-btn love-btn"},[d(i,{icon:U(o)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],8,at)])]),s("div",ot,[s("h4",null,r(T(b)==="ar"?o.name_ar:o.name_en),1),s("div",it,[s("span",nt,r(o.price)+" "+r(((g=o.currency)==null?void 0:g.name_en)||"AED"),1),o.old_price?(c(),l("span",rt,r(o.old_price)+" "+r(((I=o.currency)==null?void 0:I.name_en)||"AED"),1)):y("",!0)]),s("div",ct,[s("button",{onClick:Ce(x=>se(o),["stop"]),disabled:!o.is_available,class:"btn"},r(T(n)("add_to_cart")),9,lt)])])])}),128))])])],8,Ke)])):y("",!0)])],8,Fe)],64)}}},pt=_e(dt,[["__scopeId","data-v-ca29a5b8"]]);export{pt as default};
