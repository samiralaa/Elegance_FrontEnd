import{_ as v,H as w,b,r as k,o as i,c as a,e as x,a as e,t as l,l as g,F as h,d as F,f as p,g as A,w as m,v as c}from"./index-260107d7.js";const D={components:{Header:w},data(){return{loading:!0,error:null,user:{},showAddressDialog:!1,editingAddressId:null,addressForm:{building_name:"",floor_number:"",apartment_number:"",postal_code:"",landmark:"",city_id:"",country_id:""},addressSuccess:!1}},methods:{formatDate(o){return o?new Date(o).toLocaleDateString():"N/A"},goToResetPassword(){this.$router.push({name:"ResetPassword",query:{email:this.user.email}})},formatAddress(o){let s="";return o.country?s=this.$i18n&&this.$i18n.locale==="ar"?o.country.name_ar:o.country.name_en:o.country_id&&(s=o.country_id),[o.building_name,o.floor_number,o.apartment_number,o.postal_code,o.landmark,o.city_id,s].filter(Boolean).join(", ")},openEditDialog(o){this.editingAddressId=o.id,this.addressForm={...o},this.showAddressDialog=!0},closeEditDialog(){this.showAddressDialog=!1,this.editingAddressId=null,this.addressForm={building_name:"",floor_number:"",apartment_number:"",postal_code:"",landmark:"",city_id:"",country_id:""}},async saveAddress(o){var s,u;try{const n=await b.post(`api/address/${o}`,this.addressForm,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),t=this.user.address.findIndex(d=>d.id===o);t!==-1&&n.data&&n.data.data&&this.$set(this.user.address,t,n.data.data),this.addressSuccess=!0,this.$toast&&this.$toast.success(n.data.message||"Address updated successfully!"),setTimeout(()=>{this.addressSuccess=!1,this.closeEditDialog()},1200)}catch(n){const t=((u=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:u.message)||"Failed to update address";this.$toast&&this.$toast.error(t)}}},async created(){var o,s;try{const u=await b.get("api/me",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});this.user=u.data.data.user}catch(u){this.error=((s=(o=u.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to fetch profile"}finally{this.loading=!1}}},C={class:"profile-outer container my-5"},N={key:0,class:"d-flex flex-column align-items-center justify-content-center py-5"},I={key:1,class:"text-center text-danger"},V={key:2,class:"card p-4 shadow"},j={class:"d-flex flex-wrap justify-content-between align-items-center gap-3 mb-4"},B={class:"d-flex align-items-center gap-3"},E={class:"avatar bg-primary text-white rounded-circle d-flex justify-content-center align-items-center",style:{width:"60px",height:"60px","font-size":"24px"}},P={class:"mb-0"},S={class:"text-muted"},U={class:"d-flex flex-column gap-3"},T={class:"d-flex justify-content-between border-bottom pb-2"},H={class:"d-flex justify-content-between border-bottom pb-2"},R={class:"d-flex justify-content-between border-bottom pb-2"},z={key:0,class:"mt-4"},L={class:"mb-3"},M=["onClick"],q={key:3,class:"modal-overlay"},G={class:"modal-dialog-centered"},J={class:"modal-content bg-white p-4 rounded shadow w-100"},K={class:"form-group"},O={class:"form-group"},Q={class:"form-group"},W={class:"form-group"},X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group"},$={class:"d-flex justify-content-end gap-2 mt-2"},ee={key:0,class:"alert alert-success d-flex align-items-center mt-3"};function se(o,s,u,n,t,d){var f;const y=k("Header");return i(),a(h,null,[x(y),e("div",C,[t.loading?(i(),a("div",N,[s[10]||(s[10]=e("span",{class:"loader mb-2"},null,-1)),e("span",null,l(o.$t("profile.loading")),1)])):t.error?(i(),a("div",I,[e("span",null,l(t.error),1)])):(i(),a("div",V,[e("div",j,[e("div",B,[e("div",E,l(t.user.name?t.user.name.charAt(0).toUpperCase():"?"),1),e("div",null,[e("h5",P,l(t.user.name),1),e("small",S,l(t.user.role),1)])]),e("button",{class:"btn btn-outline-secondary d-flex align-items-center gap-1",onClick:s[0]||(s[0]=(...r)=>d.goToResetPassword&&d.goToResetPassword(...r)),"aria-label":"Reset Password"},[s[11]||(s[11]=e("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24"},[e("path",{d:"M12 15v2m0 0v2m0-2h2m-2 0H10m8-6a8 8 0 11-16 0 8 8 0 0116 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),g(" "+l(o.$t("profile.resetPassword")),1)])]),e("div",U,[e("div",T,[e("strong",null,l(o.$t("profile.name")),1),e("span",null,l(t.user.name),1)]),e("div",H,[e("strong",null,l(o.$t("profile.email")),1),e("span",null,l(t.user.email),1)]),e("div",R,[e("strong",null,l(o.$t("profile.phone")),1),e("span",null,l(t.user.phone),1)])]),(f=t.user.address)!=null&&f.length?(i(),a("div",z,[e("h6",L,l(o.$t("profile.address")),1),(i(!0),a(h,null,F(t.user.address,(r,_)=>(i(),a("div",{key:r.id||_,class:"d-flex justify-content-between align-items-center border rounded p-3 mb-2"},[e("span",null,l(d.formatAddress(r)),1),e("button",{class:"btn btn-sm btn-outline-primary",onClick:te=>d.openEditDialog(r)},"Edit",8,M)]))),128))])):p("",!0)])),t.showAddressDialog?(i(),a("div",q,[e("div",G,[e("div",J,[s[21]||(s[21]=e("h5",{class:"mb-4"},"Edit Address",-1)),e("form",{onSubmit:s[9]||(s[9]=A(r=>d.saveAddress(t.editingAddressId),["prevent"])),class:"d-flex flex-column gap-3"},[e("div",K,[s[12]||(s[12]=e("label",null,"Building Name",-1)),m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=r=>t.addressForm.building_name=r),class:"form-control",placeholder:"Building Name"},null,512),[[c,t.addressForm.building_name]])]),e("div",O,[s[13]||(s[13]=e("label",null,"Floor Number",-1)),m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=r=>t.addressForm.floor_number=r),class:"form-control",placeholder:"Floor Number"},null,512),[[c,t.addressForm.floor_number]])]),e("div",Q,[s[14]||(s[14]=e("label",null,"Apartment Number",-1)),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=r=>t.addressForm.apartment_number=r),class:"form-control",placeholder:"Apartment Number"},null,512),[[c,t.addressForm.apartment_number]])]),e("div",W,[s[15]||(s[15]=e("label",null,"Postal Code",-1)),m(e("input",{"onUpdate:modelValue":s[4]||(s[4]=r=>t.addressForm.postal_code=r),class:"form-control",placeholder:"Postal Code"},null,512),[[c,t.addressForm.postal_code]])]),e("div",X,[s[16]||(s[16]=e("label",null,"Landmark",-1)),m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=r=>t.addressForm.landmark=r),class:"form-control",placeholder:"Landmark"},null,512),[[c,t.addressForm.landmark]])]),e("div",Y,[s[17]||(s[17]=e("label",null,"City ID",-1)),m(e("input",{"onUpdate:modelValue":s[6]||(s[6]=r=>t.addressForm.city_id=r),class:"form-control",placeholder:"City ID"},null,512),[[c,t.addressForm.city_id]])]),e("div",Z,[s[18]||(s[18]=e("label",null,"Country ID",-1)),m(e("input",{"onUpdate:modelValue":s[7]||(s[7]=r=>t.addressForm.country_id=r),class:"form-control",placeholder:"Country ID"},null,512),[[c,t.addressForm.country_id]])]),e("div",$,[s[19]||(s[19]=e("button",{type:"submit",class:"btn btn-primary"},"Save",-1)),e("button",{type:"button",class:"btn btn-secondary",onClick:s[8]||(s[8]=(...r)=>d.closeEditDialog&&d.closeEditDialog(...r))},"Cancel")]),t.addressSuccess?(i(),a("div",ee,s[20]||(s[20]=[e("i",{class:"bi bi-check-circle-fill me-2"},null,-1),g(" Address updated successfully! ")]))):p("",!0)],32)])])])):p("",!0)])],64)}const re=v(D,[["render",se],["__scopeId","data-v-b8efb358"]]);export{re as default};
