import{_ as R,V as E,W as V,b,r as N,o as h,c as m,a as t,t as i,w as q,g as c,i as _,n as p,f,k as C,e as v,l as P,F,d as L,j as U,m as D}from"./index-23e6863a.js";import{_ as j}from"./perfume-banner-e9b7c37b.js";const k="http://elegance_backend.test/api",I={name:"Register",components:{ElSelect:E,ElOption:V},data(){return{formData:{fullName:"",email:"",password:"",confirmPassword:"",country_id:"",phoneNumber:""},countryCode:"",phoneNumber:"",errors:{fullName:"",email:"",password:"",confirmPassword:"",phoneNumber:"",country_id:""},countries:[],filteredCountries:[],loading:!1,showPassword:!1,showConfirmPassword:!1,countryCodes:{1:"93",2:"355",3:"213",4:"376",5:"244",6:"973",7:"880",8:"32",9:"55",10:"1",11:"86",12:"20",13:"33",14:"49",15:"30",16:"91",17:"62",18:"98",19:"964",20:"353",21:"39",22:"81",23:"962",24:"7",25:"254",26:"965",27:"961",28:"218",29:"60",30:"52",31:"212",32:"977",33:"31",34:"64",35:"234",36:"968",37:"92",38:"970",39:"974",40:"7",41:"966",42:"65",43:"27",44:"82",45:"34",46:"249",47:"46",48:"41",49:"963",50:"886",51:"255",52:"66",53:"216",54:"90",55:"256",56:"380",57:"971",58:"44",59:"1",60:"998",61:"84",62:"967",63:"263"}}},computed:{selectedCountryDialCode(){const e=this.countries.find(s=>s.id===this.formData.country_id);return e?this.getCountryCode(e.id):""},currentLocale(){var e;return((e=this.$i18n)==null?void 0:e.locale)||"en"}},created(){this.fetchCountries()},watch:{"formData.fullName"(e){this.validateFullName(e)},"formData.email"(e){this.validateEmail(e)},"formData.password"(e){this.validatePassword(e),this.formData.confirmPassword&&this.validateConfirmPassword(this.formData.confirmPassword)},"formData.confirmPassword"(e){this.validateConfirmPassword(e)},"formData.phoneNumber"(e){this.validatePhoneNumber(e)},"formData.country_id":{immediate:!0,handler(e){this.validateCountry(e),e?(this.countryCode=this.getCountryCode(e),this.phoneNumber&&this.updateFullPhoneNumber()):this.countryCode=""}},phoneNumber:{handler(e){this.updateFullPhoneNumber()}}},methods:{getCountryName(e){return this.currentLocale==="ar"?e.name_ar:e.name_en},getCountryCode(e){return this.countryCodes[e]||""},filterCountries(e){if(e){const s=e.toLowerCase();this.filteredCountries=this.countries.filter(l=>{var u,d;const n=((u=l.name_en)==null?void 0:u.toLowerCase())||"",r=((d=l.name_ar)==null?void 0:d.toLowerCase())||"",a=this.getCountryCode(l.id)||"";return n.includes(s)||r.includes(s)||a.includes(s)})}else this.filteredCountries=this.countries},async fetchCountries(){var e,s,l;try{this.loading=!0;const n=await b.get(`${k}/countries`);if(n.data.status==="success")this.countries=n.data.data||[],this.filteredCountries=this.countries,this.formData.country_id&&(this.countryCode=this.getCountryCode(this.formData.country_id),this.updateFullPhoneNumber());else throw new Error(n.data.message||"Failed to fetch countries")}catch(n){console.error("Error fetching countries:",n),(l=(e=this.$toast)==null?void 0:e.error)==null||l.call(e,((s=this.$t)==null?void 0:s.call(this,"register.errorFetchingCountries"))||"Failed to fetch countries")}finally{this.loading=!1}},validateFullName(e){e?e.length<3?this.errors.fullName=this.$t("register.validation.fullNameMinLength"):e.length>255?this.errors.fullName=this.$t("register.validation.fullNameMaxLength"):/^[\p{L}\s'-]+$/u.test(e)?this.errors.fullName="":this.errors.fullName=this.$t("register.validation.fullNameInvalid"):this.errors.fullName=this.$t("register.validation.fullNameRequired")},validateEmail(e){e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?this.errors.email="":this.errors.email=this.$t("register.validation.emailInvalid"):this.errors.email=this.$t("register.validation.emailRequired")},validatePassword(e){e?e.length<8?this.errors.password=this.$t("register.validation.passwordMinLength"):this.errors.password="":this.errors.password=this.$t("register.validation.passwordRequired")},validateConfirmPassword(e){e?e!==this.formData.password?this.errors.confirmPassword=this.$t("register.validation.confirmPasswordMatch"):this.errors.confirmPassword="":this.errors.confirmPassword=this.$t("register.validation.confirmPasswordRequired")},validatePhoneNumber(e){e?this.countryCode?e.length<10||e.length>18?this.errors.phoneNumber=this.$t("register.validation.phoneLength"):/^\d+$/.test(e)?this.errors.phoneNumber="":this.errors.phoneNumber=this.$t("register.validation.phoneInvalid"):this.errors.phoneNumber=this.$t("register.validation.countryRequired"):this.errors.phoneNumber=this.$t("register.validation.phoneRequired")},validateCountry(e){e?this.countries.some(s=>s.id===e)?this.errors.country_id="":this.errors.country_id=this.$t("register.validation.countryInvalid"):this.errors.country_id=this.$t("register.validation.countryRequired")},async handleRegister(){var e,s,l,n,r,a,u,d,g;if(this.validateFullName(this.formData.fullName),this.validateEmail(this.formData.email),this.validatePassword(this.formData.password),this.validateConfirmPassword(this.formData.confirmPassword),this.validatePhoneNumber(this.formData.phoneNumber),this.validateCountry(this.formData.country_id),!Object.values(this.errors).some(o=>o))try{const o=await b.post(`${k}/clients/register`,{name:this.formData.fullName,email:this.formData.email,password:this.formData.password,password_confirmation:this.formData.confirmPassword,country_id:this.formData.country_id,phone:this.formData.phoneNumber,role:"user"});if(o.data&&o.data.data)localStorage.setItem("user",JSON.stringify(o.data.data.user)),localStorage.setItem("auth_token",o.data.data.token),(s=(e=this.$toast)==null?void 0:e.success)==null||s.call(e,o.data.message||"Registration successful"),this.$router.push("/otp");else throw new Error("Invalid response format")}catch(o){if(console.error("Registration error:",o),(n=(l=o.response)==null?void 0:l.data)!=null&&n.errors){const w=o.response.data.errors;Object.keys(w).forEach(y=>{this.errors.hasOwnProperty(y)&&(this.errors[y]=w[y][0])})}else{const w=((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||((u=this.$t)==null?void 0:u.call(this,"register.error"))||"Registration failed";(g=(d=this.$toast)==null?void 0:d.error)==null||g.call(d,w)}}},updateFullPhoneNumber(){this.countryCode?this.formData.phoneNumber=this.countryCode+this.phoneNumber:this.formData.phoneNumber=this.phoneNumber},formatPhoneNumber(e){let s=e.target.value;s=s.replace(/\D/g,""),this.phoneNumber=s},togglePassword(){this.showPassword=!this.showPassword},toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword}}},M={class:"join-us-container"},S={class:"join-us-content"},O={class:"form-header"},B={class:"elegant-title"},A={class:"elegant-description"},H={class:"form-group"},T={for:"fullName"},z=["placeholder"],J={key:0,class:"error-message"},Q={class:"form-group"},W={for:"email"},G=["placeholder"],K={key:0,class:"error-message"},X={class:"form-group"},Y={for:"password"},Z={class:"password-input-container"},x=["type","placeholder"],$={key:0,class:"error-message"},ee={class:"form-group"},re={for:"confirmPassword"},se={class:"password-input-container"},oe=["type","placeholder"],te={key:0,class:"error-message"},ie={class:"form-group"},ae={for:"country"},ne={class:"country-option"},le={class:"country-name"},de={class:"country-code"},he={key:0,class:"error-message"},me={class:"form-group"},ue={for:"phoneNumber"},ce={class:"phone-input-container"},fe={class:"country-code-input"},pe=["placeholder"],ge=["placeholder"],we={key:0,class:"error-message"},_e={type:"submit",class:"submit-btn"},ye={class:"register-section"};function Ne(e,s,l,n,r,a){const u=N("el-option"),d=N("el-select"),g=N("router-link");return h(),m("div",M,[s[12]||(s[12]=t("div",{class:"banner-section"},[t("img",{src:j,alt:"Elegance Perfume",class:"banner-image"})],-1)),t("div",S,[t("div",O,[t("h1",B,i(e.$t("header.register")),1),t("p",A,i(e.$t("header.register")),1)]),t("form",{onSubmit:s[10]||(s[10]=q((...o)=>a.handleRegister&&a.handleRegister(...o),["prevent"])),class:"join-form"},[t("div",H,[t("label",T,i(e.$t("header.fullName")),1),c(t("input",{type:"text",id:"fullName","onUpdate:modelValue":s[0]||(s[0]=o=>r.formData.fullName=o),placeholder:e.$t("header.fullNamePlaceholder"),class:p({error:r.errors.fullName,valid:r.formData.fullName&&!r.errors.fullName}),required:""},null,10,z),[[_,r.formData.fullName]]),r.errors.fullName?(h(),m("span",J,i(r.errors.fullName),1)):f("",!0)]),t("div",Q,[t("label",W,i(e.$t("header.email")),1),c(t("input",{type:"email",id:"email","onUpdate:modelValue":s[1]||(s[1]=o=>r.formData.email=o),placeholder:e.$t("header.emailPlaceholder"),class:p({error:r.errors.email,valid:r.formData.email&&!r.errors.email}),required:""},null,10,G),[[_,r.formData.email]]),r.errors.email?(h(),m("span",K,i(r.errors.email),1)):f("",!0)]),t("div",X,[t("label",Y,i(e.$t("header.password")),1),t("div",Z,[c(t("input",{type:r.showPassword?"text":"password",id:"password","onUpdate:modelValue":s[2]||(s[2]=o=>r.formData.password=o),placeholder:e.$t("header.passwordPlaceholder"),class:p({error:r.errors.password,valid:r.formData.password&&!r.errors.password}),required:""},null,10,x),[[C,r.formData.password]]),t("button",{type:"button",class:"show-password-btn",onClick:s[3]||(s[3]=(...o)=>a.togglePassword&&a.togglePassword(...o))},i(r.showPassword?e.$t("joinUs.hidePassword"):e.$t("joinUs.showPassword")),1)]),r.errors.password?(h(),m("span",$,i(r.errors.password),1)):f("",!0)]),t("div",ee,[t("label",re,i(e.$t("header.confirmPassword")),1),t("div",se,[c(t("input",{type:r.showConfirmPassword?"text":"password",id:"confirmPassword","onUpdate:modelValue":s[4]||(s[4]=o=>r.formData.confirmPassword=o),placeholder:e.$t("register.confirmPasswordPlaceholder"),class:p({error:r.errors.confirmPassword,valid:r.formData.confirmPassword&&!r.errors.confirmPassword}),required:""},null,10,oe),[[C,r.formData.confirmPassword]]),t("button",{type:"button",class:"show-password-btn",onClick:s[5]||(s[5]=(...o)=>a.toggleConfirmPassword&&a.toggleConfirmPassword(...o))},i(r.showConfirmPassword?e.$t("joinUs.hidePassword"):e.$t("joinUs.showPassword")),1)]),r.errors.confirmPassword?(h(),m("span",te,i(r.errors.confirmPassword),1)):f("",!0)]),t("div",ie,[t("label",ae,i(e.$t("register.country")),1),v(d,{modelValue:r.formData.country_id,"onUpdate:modelValue":s[6]||(s[6]=o=>r.formData.country_id=o),class:"country-select",placeholder:e.$t("register.countryPlaceholder"),loading:r.loading,filterable:"","filter-method":a.filterCountries,"remote-method":a.filterCountries,remote:!1,required:""},{default:P(()=>[(h(!0),m(F,null,L(r.filteredCountries,o=>(h(),U(u,{key:o.id,label:a.getCountryName(o),value:o.id},{default:P(()=>[t("div",ne,[t("span",le,i(a.getCountryName(o)),1),t("span",de,"+"+i(a.getCountryCode(o.id)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","loading","filter-method","remote-method"]),r.errors.country_id?(h(),m("span",he,i(r.errors.country_id),1)):f("",!0)]),t("div",me,[t("label",ue,i(e.$t("register.phoneNumber")),1),t("div",ce,[t("div",fe,[s[11]||(s[11]=t("span",{class:"plus"},"+",-1)),c(t("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>r.countryCode=o),class:"country-code-field",readonly:"",placeholder:a.selectedCountryDialCode||"Code"},null,8,pe),[[_,r.countryCode]])]),c(t("input",{type:"tel",id:"phoneNumber","onUpdate:modelValue":s[8]||(s[8]=o=>r.phoneNumber=o),placeholder:e.$t("register.phoneNumberPlaceholder"),class:p({error:r.errors.phoneNumber,valid:r.phoneNumber&&!r.errors.phoneNumber}),required:"",minlength:"10",maxlength:"18",onInput:s[9]||(s[9]=(...o)=>a.formatPhoneNumber&&a.formatPhoneNumber(...o))},null,42,ge),[[_,r.phoneNumber]])]),r.errors.phoneNumber?(h(),m("span",we,i(r.errors.phoneNumber),1)):f("",!0)]),t("button",_e,i(e.$t("register.submit")),1),t("div",ye,[t("p",null,[D(i(e.$t("register.alreadyHaveAccount"))+" ",1),v(g,{to:"/login",class:"link"},{default:P(()=>[D(i(e.$t("register.loginHere")),1)]),_:1})])])],32)])])}const Ce=R(I,[["render",Ne],["__scopeId","data-v-0531c19f"]]);export{Ce as default};
