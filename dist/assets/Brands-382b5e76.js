import{_ as M,b as Z,R as J,r as s,V as O,o as f,c as L,a as u,t as V,e as a,m as o,w as W,i as B,f as G,a1 as H,a2 as K,a3 as Q,a6 as X,a7 as Y,a0 as x,S as ee,C as ae,x as g,a4 as oe,D as ne,l as F,W as q}from"./index-fb9faeb8.js";const N=Z.create({baseURL:"https://backend.webenia.org/api",headers:{Accept:"application/json","Content-Type":"application/json"}});N.interceptors.request.use(e=>{const n=JSON.parse(localStorage.getItem("tokenData"));return n!=null&&n.token&&(e.headers.Authorization=`Bearer ${n.token}`),e},e=>Promise.reject(e));N.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem("tokenData"),window.location.href="/login"),Promise.reject(e)});const te=J({name:"BrandsView",components:{Edit:H,Delete:K,Plus:Q,Picture:X,ZoomIn:Y,Refresh:x},setup(){const e=ee(),n=ae(),E=g(null),C=g(!1),$=g(!1),w=g("create"),y=g([]),p=g(!1),c=g(!1),D=g(!1),b=g(null),h=g(null),r=oe({logo:"",name_en:"",name_ar:"",description_en:"",description_ar:""}),I={name_en:[{required:!0,message:"Please enter brand name in English",trigger:"blur"}],name_ar:[{required:!0,message:"Please enter brand name in Arabic",trigger:"blur"}],description_en:[{required:!0,message:"Please enter brand description in English",trigger:"blur"}],description_ar:[{required:!0,message:"Please enter brand description in Arabic",trigger:"blur"}]},m=async()=>{var t,i,_;try{p.value=!0,h.value=null;const d=JSON.parse(localStorage.getItem("tokenData"));if(!(d!=null&&d.token)){console.error("No token found"),n.push("/login");return}await e.dispatch("fetchBrands"),y.value=e.getters.getBrands,console.log("Brands loaded:",y.value)}catch(d){console.error("Error loading brands:",d),h.value=((i=(t=d.response)==null?void 0:t.data)==null?void 0:i.message)||d.message||"Failed to load brands",((_=d.response)==null?void 0:_.status)===401&&(localStorage.removeItem("tokenData"),n.push("/login"))}finally{p.value=!1}},P=()=>{w.value="create",r.logo="",r.name_en="",r.name_ar="",r.description_en="",r.description_ar="",C.value=!0},A=t=>{var i,_;w.value="edit",b.value=t,r.logo=((_=(i=t.media)==null?void 0:i[0])==null?void 0:_.original_url)||"",r.name_en=t.name_en,r.name_ar=t.name_ar,r.description_en=t.description_en,r.description_ar=t.description_ar,C.value=!0},z=t=>{b.value=t,$.value=!0},R=t=>{if(t){const i=new FileReader;i.onload=_=>{r.logo=_.target.result},i.readAsDataURL(t.raw)}},U=async()=>{try{if(!E.value)return;await E.value.validate(),c.value=!0;const t=new FormData;if(t.append("name_en",r.name_en),t.append("name_ar",r.name_ar),t.append("description_en",r.description_en||""),t.append("description_ar",r.description_ar||""),r.logo instanceof File)t.append("logo",r.logo);else if(r.logo&&typeof r.logo=="string"){const d=await(await fetch(r.logo)).blob(),T=new File([d],"logo.png",{type:"image/png"});t.append("logo",T)}const i=w.value==="create"?"/brands":`/brands/${b.value.id}`;await N.post(i,t,{headers:{"Content-Type":"multipart/form-data"}}),q({message:`Brand ${w.value==="create"?"created":"updated"} successfully`,type:"success",duration:2e3}),C.value=!1,m()}catch{}finally{c.value=!1}},S=async()=>{try{D.value=!0,await N.delete(`/brands/${b.value.id}`),q({message:"Brand deleted successfully",type:"success",duration:2e3}),$.value=!1,m()}catch(t){console.error("Error deleting brand:",t),q({message:"Failed to delete brand",type:"error",duration:5e3})}finally{D.value=!1}},v=t=>{if(t.media&&t.media.length>0){const i=t.media[0].original_url;window.open(i,"_blank")}},k=()=>{h.value=null};return ne(()=>{m()}),{brands:y,loading:p,error:h,dialogVisible:C,deleteDialogVisible:$,dialogType:w,submitting:c,deleting:D,selectedBrand:b,brandForm:r,formRules:I,brandFormRef:E,fetchBrands:m,openCreateDialog:P,editItem:A,deleteItem:z,handleLogoChange:R,submitForm:U,confirmDelete:S,previewImage:v,clearError:k}}}),le={class:"brands-container"},re={class:"header"},se={class:"text-2xl font-bold text-gray-800"},ie={key:0,class:"loading-state"},de={key:1,class:"table-container"},ue={class:"d-flex align-center brand-name"},ce=["onClick"],pe={class:"logo-overlay"},me={class:"text-right arabic-text",dir:"rtl"},_e={class:"description-cell"},ge={class:"text-right arabic-text",dir:"rtl"},fe={class:"button-group"},be={class:"dialog-footer"},ve={class:"dialog-footer"};function we(e,n,E,C,$,w){const y=s("Plus"),p=s("el-icon"),c=s("el-button"),D=s("el-skeleton"),b=s("el-image"),h=s("Picture"),r=s("el-avatar"),I=s("ZoomIn"),m=s("el-table-column"),P=s("Edit"),A=s("el-tooltip"),z=s("Delete"),R=s("el-table"),U=s("el-empty"),S=s("el-upload"),v=s("el-form-item"),k=s("el-input"),t=s("el-col"),i=s("el-row"),_=s("el-form"),d=s("el-dialog"),T=O("loading");return f(),L("div",le,[u("div",re,[u("h1",se,V(e.$t("Brands.Management")),1),a(c,{type:"primary",onClick:e.openCreateDialog,class:"add-brand-btn"},{default:o(()=>[a(p,{class:"mr-2"},{default:o(()=>[a(y)]),_:1}),F(" "+V(e.$t("Brands.AddBrands")),1)]),_:1},8,["onClick"])]),e.loading?(f(),L("div",ie,[a(D,{rows:5,animated:""})])):(f(),L("div",de,[W((f(),B(R,{data:e.brands,style:{width:"100%"},border:!0},{default:o(()=>[a(m,{label:e.$t("Brands.Logo"),"min-width":"200",resizable:!0},{default:o(l=>[u("div",ue,[u("div",{class:"brand-logo-container",onClick:j=>e.previewImage(l.row)},[a(r,{size:120,class:"brand-logo"},{default:o(()=>[l.row.media&&l.row.media.length>0?(f(),B(b,{key:0,src:l.row.media[0].original_url,class:"logo-img","preview-src-list":[l.row.media[0].original_url]},null,8,["src","preview-src-list"])):(f(),B(p,{key:1,size:"24",color:"#909399"},{default:o(()=>[a(h)]),_:1}))]),_:2},1024),u("div",pe,[a(p,null,{default:o(()=>[a(I)]),_:1})])],8,ce)])]),_:1},8,["label"]),a(m,{prop:"name_ar",label:e.$t("Brands.NameAr"),"min-width":"150",resizable:!0},{default:o(l=>[u("div",me,V(l.row.name_ar||"N/A"),1)]),_:1},8,["label"]),a(m,{prop:"description_en",label:e.$t("Brands.DescriptionEn"),"min-width":"200",resizable:!0},{default:o(l=>[u("div",_e,V(l.row.description_en||"N/A"),1)]),_:1},8,["label"]),a(m,{prop:"description_ar",label:e.$t("Brands.DescriptionAr"),"min-width":"200",resizable:!0},{default:o(l=>[u("div",ge,V(l.row.description_ar||"N/A"),1)]),_:1},8,["label"]),a(m,{label:e.$t("Brands.Actions"),width:"100",fixed:"right"},{default:o(l=>[u("div",fe,[a(A,{content:"Edit Brand",placement:"top"},{default:o(()=>[a(c,{type:"primary",size:"small",class:"action-button",onClick:j=>e.editItem(l.row)},{default:o(()=>[a(p,null,{default:o(()=>[a(P)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(A,{content:"Delete Brand",placement:"top"},{default:o(()=>[a(c,{type:"danger",size:"small",class:"action-button",onClick:j=>e.deleteItem(l.row)},{default:o(()=>[a(p,null,{default:o(()=>[a(z)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])),[[T,e.loading]]),!e.loading&&e.brands.length===0?(f(),B(U,{key:0,description:"No brands found"})):G("",!0)])),a(d,{modelValue:e.dialogVisible,"onUpdate:modelValue":n[5]||(n[5]=l=>e.dialogVisible=l),title:e.dialogType==="create"?"Create New Brand":"Edit Brand",width:"600px","close-on-click-modal":!1},{footer:o(()=>[u("span",be,[a(c,{onClick:n[4]||(n[4]=l=>e.dialogVisible=!1)},{default:o(()=>n[8]||(n[8]=[F("Cancel")])),_:1,__:[8]}),a(c,{type:"primary",onClick:e.submitForm,loading:e.submitting},{default:o(()=>[F(V(e.dialogType==="create"?"Create":"Update"),1)]),_:1},8,["onClick","loading"])])]),default:o(()=>[a(_,{ref:"brandFormRef",model:e.brandForm,rules:e.formRules,"label-position":"top"},{default:o(()=>[a(v,{label:"Brand Logo",prop:"logo"},{default:o(()=>[a(S,{class:"logo-uploader",action:"#","show-file-list":!1,"auto-upload":!1,"on-change":e.handleLogoChange},{default:o(()=>[e.brandForm.logo?(f(),B(b,{key:0,src:e.brandForm.logo,class:"logo-preview"},null,8,["src"])):(f(),B(p,{key:1,class:"logo-uploader-icon"},{default:o(()=>[a(y)]),_:1}))]),_:1},8,["on-change"])]),_:1}),a(i,{gutter:20},{default:o(()=>[a(t,{span:12},{default:o(()=>[a(v,{label:"Name (English)",prop:"name_en"},{default:o(()=>[a(k,{modelValue:e.brandForm.name_en,"onUpdate:modelValue":n[0]||(n[0]=l=>e.brandForm.name_en=l),placeholder:"Enter brand name in English"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:o(()=>[a(v,{label:"Name (Arabic)",prop:"name_ar"},{default:o(()=>[a(k,{modelValue:e.brandForm.name_ar,"onUpdate:modelValue":n[1]||(n[1]=l=>e.brandForm.name_ar=l),placeholder:"Enter brand name in Arabic",dir:"rtl"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(i,{gutter:20},{default:o(()=>[a(t,{span:12},{default:o(()=>[a(v,{label:"Description (English)",prop:"description_en"},{default:o(()=>[a(k,{modelValue:e.brandForm.description_en,"onUpdate:modelValue":n[2]||(n[2]=l=>e.brandForm.description_en=l),type:"textarea",rows:3,placeholder:"Enter brand description in English"},null,8,["modelValue"])]),_:1})]),_:1}),a(t,{span:12},{default:o(()=>[a(v,{label:"Description (Arabic)",prop:"description_ar"},{default:o(()=>[a(k,{modelValue:e.brandForm.description_ar,"onUpdate:modelValue":n[3]||(n[3]=l=>e.brandForm.description_ar=l),type:"textarea",rows:3,placeholder:"Enter brand description in Arabic",dir:"rtl"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(d,{modelValue:e.deleteDialogVisible,"onUpdate:modelValue":n[7]||(n[7]=l=>e.deleteDialogVisible=l),title:"Delete Brand",width:"400px","close-on-click-modal":!1},{footer:o(()=>[u("span",ve,[a(c,{onClick:n[6]||(n[6]=l=>e.deleteDialogVisible=!1)},{default:o(()=>n[9]||(n[9]=[F("Cancel")])),_:1,__:[9]}),a(c,{type:"danger",onClick:e.confirmDelete,loading:e.deleting},{default:o(()=>n[10]||(n[10]=[F(" Delete ")])),_:1,__:[10]},8,["onClick","loading"])])]),default:o(()=>[n[11]||(n[11]=u("p",null,"Are you sure you want to delete this brand? This action cannot be undone.",-1))]),_:1,__:[11]},8,["modelValue"])])}const he=M(te,[["render",we],["__scopeId","data-v-5a574cfe"]]);export{he as default};
