import{_ as h,b as c,o as l,c as d,a as e,t as i,f as u,g as _,k as v,w as m,v as g,h as b,F as y,d as w}from"./index-db8d7353.js";const C={name:"CreateCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const r=JSON.parse(localStorage.getItem("tokenData"));r!=null&&r.token&&(c.defaults.headers.common.Authorization=`Bearer ${r.token}`);const s=await c.get("https://backend.webenia.org/api/brands");if(s.data.status){const n=s.data.data;this.brands=Array.isArray(n)?n:[n]}else throw new Error(s.data.message||"Failed to fetch brands")}catch(r){console.error("Error fetching brands:",r),alert("Failed to load brands")}},onFileChange(r){const s=r.target.files[0];s?(this.form.image=s,this.imagePreview=URL.createObjectURL(s)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var r,s,n,p,t;this.successMessage="",this.errorMessage="",this.loading=!0;try{const o=new FormData;o.append("name_en",this.form.name),o.append("name_ar",this.form.name_ar),o.append("description_en",this.form.description),o.append("description_ar",this.form.description_ar),o.append("brand_id",this.form.brand_id),this.form.image&&o.append("image",this.form.image);const a=JSON.parse(localStorage.getItem("tokenData"));a!=null&&a.token&&(c.defaults.headers.common.Authorization=`Bearer ${a.token}`);const f=await c.post("https://backend.webenia.org/api/categories",o,{headers:{"Content-Type":"multipart/form-data"}});if((r=f.data)!=null&&r.status&&((s=f.data)!=null&&s.data))this.loading=!1,this.successMessage="Category created successfully!",this.form={name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},this.imagePreview=null,setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((n=f.data)==null?void 0:n.message)||"Failed to create category")}catch(o){this.loading=!1,this.errorMessage=((t=(p=o.response)==null?void 0:p.data)==null?void 0:t.message)||o.message||"An error occurred while creating the category."}}}},k={class:"category-create"},M={class:"form-card"},B={class:"form-title"},F={key:0,class:"loading-overlay"},S={key:1,class:"success-message"},A={key:2,class:"error-message"},P={class:"form-group"},U={class:"form-group"},V={class:"form-group"},q={class:"form-group"},D={class:"form-group"},E={disabled:"",value:""},I=["value"],N={class:"form-group"},z={class:"file-input-wrapper"},L={key:0,class:"image-preview-container"},O={class:"preview-title"},T={class:"image-preview"},J=["src"],R={type:"submit",class:"submit-button"};function j(r,s,n,p,t,o){return l(),d("div",k,[e("div",M,[e("h2",B,i(r.$t("Categories.AddCategory")),1),t.loading?(l(),d("div",F,s[7]||(s[7]=[e("span",{class:"spinner"},null,-1)]))):u("",!0),t.successMessage?(l(),d("div",S,i(t.successMessage),1)):u("",!0),t.errorMessage?(l(),d("div",A,i(t.errorMessage),1)):u("",!0),e("form",{onSubmit:s[6]||(s[6]=_((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"])),style:v(t.loading?"pointer-events:none;opacity:0.5;":"")},[e("div",P,[e("label",null,i(r.$t("Categories.NameEn")),1),m(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.form.name=a),required:"",class:"form-input"},null,512),[[g,t.form.name]])]),e("div",U,[e("label",null,i(r.$t("Categories.NameAr")),1),m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.form.name_ar=a),required:"",class:"form-input"},null,512),[[g,t.form.name_ar]])]),e("div",V,[e("label",null,i(r.$t("Categories.DescriptionEn")),1),m(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.form.description=a),required:"",class:"form-input form-textarea"},null,512),[[g,t.form.description]])]),e("div",q,[e("label",null,i(r.$t("Categories.DescriptionAr")),1),m(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.form.description_ar=a),required:"",class:"form-input form-textarea"},null,512),[[g,t.form.description_ar]])]),e("div",D,[e("label",null,i(r.$t("Categories.Brand")),1),m(e("select",{"onUpdate:modelValue":s[4]||(s[4]=a=>t.form.brand_id=a),required:"",class:"form-input form-select"},[e("option",E,i(r.$t("Categories.SelectBrand")),1),(l(!0),d(y,null,w(t.brands,a=>(l(),d("option",{key:a.id,value:a.id},i(a.name_en),9,I))),128))],512),[[b,t.form.brand_id]])]),e("div",N,[e("label",null,i(r.$t("Categories.Image")),1),e("div",z,[e("input",{type:"file",onChange:s[5]||(s[5]=(...a)=>o.onFileChange&&o.onFileChange(...a)),accept:"image/*",required:"",class:"form-input file-input"},null,32)])]),t.imagePreview?(l(),d("div",L,[e("p",O,i(r.$t("Categories.ImagePreview")),1),e("div",T,[e("img",{src:t.imagePreview,alt:"Image Preview"},null,8,J)])])):u("",!0),e("button",R,i(r.$t("Categories.CreateButton")),1)],36)])])}const G=h(C,[["render",j],["__scopeId","data-v-09f2f47f"]]);export{G as default};
