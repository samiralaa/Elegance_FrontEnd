import{_ as k,J as C,I as E,u as g,z as V,r as d,o as N,c as R,e as r,l as o,U as l,b as m,a as $,m as y,L as A}from"./index-f73fdb68.js";const U={class:"currency-edit-container"},B="https://backend.webenia.org",I={__name:"Edit",setup(w){const _=C(),i=E().params.id,p=g(null),t=g({name_en:"",name_ar:"",exchange_rate:""}),v={name_en:[{required:!0,message:"Please enter name (EN)",trigger:"blur"}],name_ar:[{required:!0,message:"Please enter name (AR)",trigger:"blur"}],exchange_rate:[{required:!0,message:"Please enter exchange rate",trigger:"blur"},{pattern:/^\d+(\.\d{1,2})?$/,message:"Must be a valid number",trigger:"blur"}]},f=`${B}/api/currencies`;V(async()=>{try{const n=JSON.parse(localStorage.getItem("tokenData"));if(!(n!=null&&n.token)){l.error("Authorization token is missing");return}m.defaults.headers.common.Authorization=`Bearer ${n.token}`;const{data:e}=await m.get(`${f}/${i}`);e&&e.data?t.value={name_en:e.data.name_en,name_ar:e.data.name_ar,exchange_rate:e.data.exchange_rate}:l.error("Currency not found")}catch{l.error("Failed to fetch currency data")}});const x=()=>{p.value.validate(async n=>{var e;if(n)try{const a=JSON.parse(localStorage.getItem("tokenData"));if(!(a!=null&&a.token)){l.error("Authorization token is missing");return}m.defaults.headers.common.Authorization=`Bearer ${a.token}`,await m.post(`${f}/${i}`,t.value),l.success("Currency updated successfully"),_.push("/currencies")}catch(a){if(((e=a.response)==null?void 0:e.status)===422){const s=a.response.data.errors;for(const c in s)l.error(s[c][0])}else l.error("Failed to update currency")}})};return(n,e)=>{const a=d("el-input"),s=d("el-form-item"),c=d("el-button"),b=d("el-form"),h=d("el-card");return N(),R("div",U,[r(h,{class:"currency-card"},{default:o(()=>[e[6]||(e[6]=$("h2",null,"Edit Currency",-1)),r(b,{model:t.value,ref_key:"formRef",ref:p,rules:v,"label-width":"120px"},{default:o(()=>[r(s,{label:"Name (EN)",prop:"name_en"},{default:o(()=>[r(a,{modelValue:t.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=u=>t.value.name_en=u)},null,8,["modelValue"])]),_:1}),r(s,{label:"Name (AR)",prop:"name_ar"},{default:o(()=>[r(a,{modelValue:t.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=u=>t.value.name_ar=u)},null,8,["modelValue"])]),_:1}),r(s,{label:"Exchange Rate",prop:"exchange_rate"},{default:o(()=>[r(a,{modelValue:t.value.exchange_rate,"onUpdate:modelValue":e[2]||(e[2]=u=>t.value.exchange_rate=u)},null,8,["modelValue"])]),_:1}),r(s,null,{default:o(()=>[r(c,{type:"primary",onClick:x},{default:o(()=>e[4]||(e[4]=[y("Update")])),_:1,__:[4]}),r(c,{onClick:e[3]||(e[3]=u=>A(_).push("/currencies"))},{default:o(()=>e[5]||(e[5]=[y("Cancel")])),_:1,__:[5]})]),_:1})]),_:1},8,["model"])]),_:1,__:[6]})])}}},q=k(I,[["__scopeId","data-v-1fd1da12"]]);export{q as default};
