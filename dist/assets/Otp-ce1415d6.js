import{_,b as g,o as h,c as f,a as n,t as u,F as m,d as y,w as v,g as k,i as $}from"./index-1a54cba5.js";const S="http://elegance_backend.test/api",b={data(){return{otp:Array(6).fill(""),user:null,token:null}},created(){const t=localStorage.getItem("user"),e=localStorage.getItem("auth_token");if(!t||!e){this.$router.push("/register");return}this.user=JSON.parse(t),this.token=e},methods:{focusNext(t){t<6&&this.otp[t-1]&&this.$el.querySelectorAll(".otp-input")[t].focus()},handleKeyDown(t,e){t.key==="Backspace"&&!this.otp[e-1]&&e>1&&this.$el.querySelectorAll(".otp-input")[e-2].focus()},async handleOtpVerification(){var e,l,c,i,r,o,s,d;const t=this.otp.join("");if(t.length!==6){(c=(e=this.$toast)==null?void 0:e.error)==null||c.call(e,((l=this.$t)==null?void 0:l.call(this,"otp.invalidLength"))||"Please enter all 6 digits");return}try{const a=await g.post(`${S}/client/verify-otp`,{otp:t,email:this.user.email},{headers:{Authorization:`Bearer ${this.token}`}});if(a.data.status===!0){const p={...this.user,...a.data.data.user};localStorage.setItem("user",JSON.stringify(p)),localStorage.setItem("token",a.data.data.token),this.$router.push("/")}}catch(a){console.error("OTP verification error:",a);const p=((r=(i=a.response)==null?void 0:i.data)==null?void 0:r.message)||((o=this.$t)==null?void 0:o.call(this,"otp.error"))||"OTP verification failed";(d=(s=this.$toast)==null?void 0:s.error)==null||d.call(s,p)}}}},w={class:"otp-container"},O={class:"otp-message"},I={class:"otp-input-group"},D=["onUpdate:modelValue","onInput","onKeydown"],V={type:"submit",class:"verify-btn"};function A(t,e,l,c,i,r){return h(),f("div",w,[n("h2",null,u(t.$t("otp.title")),1),n("p",O,u(t.$t("otp.message")),1),n("form",{onSubmit:e[0]||(e[0]=v((...o)=>r.handleOtpVerification&&r.handleOtpVerification(...o),["prevent"]))},[n("div",I,[(h(),f(m,null,y(6,o=>k(n("input",{key:o,type:"text",maxlength:"1","onUpdate:modelValue":s=>i.otp[o-1]=s,onInput:s=>r.focusNext(o),onKeydown:s=>r.handleKeyDown(s,o),class:"otp-input",placeholder:"0"},null,40,D),[[$,i.otp[o-1]]])),64))]),n("button",V,u(t.$t("otp.verify")),1)],32)])}const N=_(b,[["render",A],["__scopeId","data-v-0d6c19b4"]]);export{N as default};
