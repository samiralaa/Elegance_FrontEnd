import{_ as m,b as v,o as g,c as y,a as n,t as h,F as $,d as k,w as O,g as b,i as w}from"./index-67b7e0a9.js";const S="http://elegance_backend.test/api",I={data(){return{otp:Array(6).fill(""),user:null,token:null}},created(){const t=localStorage.getItem("user"),e=localStorage.getItem("auth_token");if(!t||!e){this.$router.push("/register");return}this.user=JSON.parse(t),this.token=e},methods:{focusNext(t){t<6&&this.otp[t-1]&&this.$el.querySelectorAll(".otp-input")[t].focus()},handleKeyDown(t,e){t.key==="Backspace"&&!this.otp[e-1]&&e>1&&this.$el.querySelectorAll(".otp-input")[e-2].focus()},async handleOtpVerification(){var e,c,p,o,r,s,a,d,f,l,_;const t=this.otp.join("");if(t.length!==6){(p=(e=this.$toast)==null?void 0:e.error)==null||p.call(e,((c=this.$t)==null?void 0:c.call(this,"otp.invalidLength"))||"Please enter all 6 digits");return}try{const i=await v.post(`${S}/verify-otp`,{otp:t,email:this.user.email},{headers:{Authorization:`Bearer ${this.token}`}});if(i.data.success){const u={...this.user,id:i.data.user.id};localStorage.setItem("user",JSON.stringify(u)),(s=(o=this.$toast)==null?void 0:o.success)==null||s.call(o,((r=this.$t)==null?void 0:r.call(this,"otp.success"))||"OTP verified successfully"),this.$router.push("/")}}catch(i){console.error("OTP verification error:",i);const u=((d=(a=i.response)==null?void 0:a.data)==null?void 0:d.message)||((f=this.$t)==null?void 0:f.call(this,"otp.error"))||"OTP verification failed";(_=(l=this.$toast)==null?void 0:l.error)==null||_.call(l,u)}}}},D={class:"otp-container"},V={class:"otp-message"},A={class:"otp-input-group"},B=["onUpdate:modelValue","onInput","onKeydown"],N={type:"submit",class:"verify-btn"};function P(t,e,c,p,o,r){return g(),y("div",D,[n("h2",null,h(t.$t("otp.title")),1),n("p",V,h(t.$t("otp.message")),1),n("form",{onSubmit:e[0]||(e[0]=O((...s)=>r.handleOtpVerification&&r.handleOtpVerification(...s),["prevent"]))},[n("div",A,[(g(),y($,null,k(6,s=>b(n("input",{key:s,type:"text",maxlength:"1","onUpdate:modelValue":a=>o.otp[s-1]=a,onInput:a=>r.focusNext(s),onKeydown:a=>r.handleKeyDown(a,s),class:"otp-input",placeholder:"0"},null,40,B),[[w,o.otp[s-1]]])),64))]),n("button",N,h(t.$t("otp.verify")),1)],32)])}const T=m(I,[["render",P],["__scopeId","data-v-a7af6ba0"]]);export{T as default};
