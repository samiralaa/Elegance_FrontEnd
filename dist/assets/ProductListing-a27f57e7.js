import{_ as R,z as H,u as d,x as O,B as j,G,r as S,o as c,c as l,e as b,a as t,t as o,w as J,L as w,F as C,d as V,g as F,i as E,f as _,b as f,H as K,m as Q,ab as W,l as X,n as Y,E as y}from"./index-67b7e0a9.js";const Z={class:"axil-breadcrumb-area mt-5"},ee={class:"container"},se={class:"row align-items-center"},te={class:"col-lg-6 col-md-8"},ae={class:"inner"},oe={class:"title"},ie=["dir"],ne={class:"container"},re={class:"filter col-12"},ce={class:"sidebar"},le={class:"sidebar-container"},de={class:"sidebar-title"},ue={class:"checkbox-container"},me=["value"],_e={class:"sidebar-title"},ve={class:"price-range"},ge=["min","max"],he=["min","max"],pe={class:"price-values"},be={class:"products-grid"},fe={class:"image-container mb-3 bg-light rounded"},ye=["src","alt"],ke={key:1,class:"sale-badge"},xe={class:"product-actions d-flex justify-content-center gap-5 w-100"},we=["onClick","title"],Ce={class:"card-body"},Fe={class:"card-title"},Pe={class:"price-container"},Le={key:0,class:"discount-badge"},$e={key:1,class:"price-old"},Se={class:"card-text card-price"},Ve={class:"addToCart-btn"},Ee=["disabled","onClick"],Ie={__name:"ProductListing",setup(Ae){const{t:u}=H(),I=d(document.documentElement.dir||"ltr"),P=d([]),L=d([]),A=d(!1),$=d(""),v=d([]),r=d({min:0,max:5e3}),m={min:0,max:5e3},g=d(!1),h=O(),k=()=>{g.value=!g.value;const e=document.querySelector(".sidebar"),a=document.body;e&&(e.classList.toggle("active",g.value),e.classList.contains("active")?a.classList.add("no-scroll"):a.classList.remove("no-scroll"))},D=e=>`http://elegance_backend.test/public/storage/${e}`,p=e=>h.favorites.some(a=>a.product_id===e),T=e=>{const a=h.favorites.find(n=>n.product_id===e);return a?a.id:null},B=async e=>{var a,n;try{const i=await f.post("http://elegance_backend.test/api/favorites",{product_id:e.id},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(p(e.id)){const s=T(e.id);s&&(await h.removeFromFavorites(s),$.value="Product removed from favorites")}else{const s=await h.addToFavorites(e.id);$.value=s.message}A.value=!0}catch(i){console.error("Favorite error:",i),y({title:"⚠️",message:((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"Login required to favorite product",type:"error"})}},M=async()=>{try{const e=await f.get("http://elegance_backend.test/api/website");P.value=e.data.data||[]}catch(e){console.error("Error loading categories",e)}},N=async()=>{try{const e=await f.get("http://elegance_backend.test/api/all/products");L.value=e.data.data||[]}catch(e){console.error("Error loading products",e)}},z=async e=>{var a,n;try{const i=await f.post("http://elegance_backend.test/api/cart-items",{product_id:e.id,quantity:1,price:parseFloat(e.price)},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});i.data.status?y({title:u("success"),message:i.data.message,type:"success"}):y({title:u("error"),message:i.data.message,type:"error"})}catch(i){console.error("Error adding to cart:",i),y({title:u("error"),message:(n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message,type:"error"})}};j(()=>{M(),N()});const U=G(()=>L.value.filter(e=>{const a=v.value.length===0||v.value.includes(e.category_id),i=r.value.min===m.min&&r.value.max===m.max?!0:e.price>=r.value.min&&e.price<=r.value.max;return a&&i})),q=e=>{if(e.discount&&e.discount.length>0){const a=parseFloat(e.discount[0].discount_value),n=parseFloat(e.price);return(n-n*(a/100)).toFixed(2)}return e.price};return(e,a)=>{const n=S("fa"),i=S("router-link");return c(),l(C,null,[b(K),t("div",Z,[t("div",ee,[t("div",se,[t("div",te,[t("div",ae,[t("h1",oe,o(e.$t("products.title")),1)])])])])]),t("div",{class:"shop-container",dir:I.value},[t("div",ne,[t("div",re,[t("a",{href:"#",onClick:J(k,["prevent"])},o(e.$t("products.filter")),1)]),t("aside",ce,[t("div",le,[t("button",{class:"close-btn",onClick:k},"×"),t("h3",de,o(w(u)("products.categories")),1),a[4]||(a[4]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),(c(!0),l(C,null,V(P.value,s=>(c(),l("div",{key:s.id,class:"filter-item"},[t("label",ue,[Q(o(e.$i18n.locale==="ar"?s.name_ar:s.name_en)+" ",1),F(t("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=x=>v.value=x),value:s.id},null,8,me),[[W,v.value]]),a[3]||(a[3]=t("span",{class:"checkmark"},null,-1))])]))),128)),t("h3",_e,o(w(u)("products.price")),1),a[5]||(a[5]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),t("div",ve,[F(t("input",{type:"range","onUpdate:modelValue":a[1]||(a[1]=s=>r.value.min=s),min:m.min,max:m.max},null,8,ge),[[E,r.value.min,void 0,{number:!0}]]),F(t("input",{type:"range","onUpdate:modelValue":a[2]||(a[2]=s=>r.value.max=s),min:m.min,max:m.max},null,8,he),[[E,r.value.max,void 0,{number:!0}]]),t("div",pe,[t("span",null,o(r.value.min)+" - "+o(r.value.max)+" "+o(w(u)("AED")),1)])])])]),g.value?(c(),l("div",{key:0,class:"overlay",onClick:k})):_("",!0),t("section",be,[(c(!0),l(C,null,V(U.value,s=>(c(),l("div",{key:s.id,class:"product-card"},[t("div",fe,[s.images&&s.images.length?(c(),l("img",{key:0,src:D(s.images[0].path),alt:s.name},null,8,ye)):_("",!0),s.is_available?_("",!0):(c(),l("div",ke,o(e.$t("products.outOfStock")),1)),t("div",xe,[b(i,{to:`/read/products/${s.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:X(()=>[b(n,{icon:"eye"})]),_:2},1032,["to"]),t("button",{onClick:x=>B(s),class:Y(["btn rounded-circle shadow-sm btn-light",p(s.id)?"text-danger":""]),title:p(s.id)?"Remove from favorites":"Add to favorites"},[b(n,{icon:p(s.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,we)])]),t("div",Ce,[t("h5",Fe,o(s.name_en),1),t("div",Pe,[s.discount&&s.discount.length>0?(c(),l("span",Le,o(s.discount[0].discount_value)+"% OFF ",1)):_("",!0),s.old_price?(c(),l("span",$e,o(s.old_price)+" "+o(s.currency.name_en),1)):_("",!0),t("span",Se,o(q(s))+" "+o(s.currency.name_en),1)])]),t("div",Ve,[t("button",{disabled:!s.is_available,onClick:x=>z(s),class:"btn"},o(e.$t("products.addToCart")),9,Ee)])]))),128))])])],8,ie)],64)}}},Te=R(Ie,[["__scopeId","data-v-62ef52e1"]]);export{Te as default};
