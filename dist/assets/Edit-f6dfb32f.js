import{_ as K,D as Q,M as X,y as v,L as Z,E as x,r as c,o as d,c as p,e as u,p as o,b as s,a as h,t as V,F as b,m as B,d as g,k as y,f as U,W as ee}from"./index-2c18e476.js";const le={class:"product-edit-container"},ae={key:2,class:"image-preview-list",style:{"margin-bottom":"1em"}},te=["src"],ue={class:"el-upload__text"},f="https://backend.webenia.org",oe={__name:"Edit",setup(re){const D=Q(),I=X(),w=v(null),C=I.params.id,a=v({name_en:"",name_ar:"",price:"",is_available:1,description_en:"",description_ar:"",category_id:null,currency_id:null,country_id:null,parent_id:null,brand_id:null,images:[],amount_required:!1,unit_id:null,weight:null,amount_price:null}),A={name_en:[{required:!0,message:"Required",trigger:"blur"}],price:[{required:!0,message:"Required",trigger:"blur"}]},$=v([]),P=v([]),E=v([]),R=v([]),S=v([]),q=v([]),F=t=>(localStorage.getItem("lang")||"en")==="ar"?t.name_ar:t.name_en,L=Z(()=>P.value.filter(t=>!t.is_deleted)),N=t=>t?typeof t=="object"&&t.url?t.url:t.startsWith("http")?t:`${f}/public/storage/${t}`:"",M=async()=>{var _;const t=(_=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:_.token;s.defaults.headers.common.Authorization=`Bearer ${t}`;const[e,i,r,n,k,m]=await Promise.all([s.get(`${f}/api/categories`),s.get(`${f}/api/currencies`),s.get(`${f}/api/countries`),s.get(`${f}/api/products`),s.get(`${f}/api/brands`),s.get(`${f}/api/units`)]);$.value=e.data.data,P.value=i.data,E.value=r.data.data,R.value=n.data.data,S.value=k.data.data,q.value=m.data.data},O=async()=>{try{const e=(await s.get(`/api/products/${C}`)).data.data;a.value.name_ar=e.name_ar,a.value.name_en=e.name_en,a.value.description_ar=e.description_ar,a.value.description_en=e.description_en,a.value.price=e.price,a.value.currency_id=e.currency_id,a.value.country_id=e.country_id,a.value.brand_id=e.brand_id,a.value.parent_id=e.parent_id,a.value.quantity=e.quantity??1,a.value.type=e.type??"product",a.value.offer=e.discount?"1":"0",a.value.offer_price=e.discount?e.discounted_price:"",a.value.category_id=e.category_id,a.value.images=e.images.map(n=>({id:n.id,path:n.path,url:N(n.path)}));const[i,r]=await Promise.all([s.get("/api/categories"),s.get("/api/currencies")]);$.value=i.data,P.value=r.data}catch(t){console.error("Error loading product data",t)}},T=(t,e)=>a.value.images=e,W=(t,e)=>a.value.images=e,z=()=>{w.value.validate(async t=>{var r;if(!t)return;const e=new FormData;for(const n in a.value)n!=="images"&&a.value[n]!==null&&e.append(n,a.value[n]);a.value.images.forEach(n=>{n.raw?e.append("images[]",n.raw):n.id&&e.append("existing_images[]",n.id)});const i=(r=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:r.token;s.defaults.headers.common.Authorization=`Bearer ${i}`,await s.post(`${f}/api/products/${C}?_method=PUT`,e,{headers:{"Content-Type":"multipart/form-data"}}),ee.success("Product updated successfully"),D.push("/products")})};return x(()=>{M(),O()}),(t,e)=>{const i=c("el-input"),r=c("el-form-item"),n=c("el-switch"),k=c("el-divider"),m=c("el-option"),_=c("el-select"),J=c("el-upload"),j=c("el-button"),Y=c("el-form"),G=c("el-card");return d(),p("div",le,[u(G,{class:"product-card"},{default:o(()=>[h("h2",null,V(t.$t("Products.EditProduct")),1),u(Y,{model:a.value,ref_key:"formRef",ref:w,rules:A,"label-width":"120px",enctype:"multipart/form-data"},{default:o(()=>[u(r,{label:t.$t("Products.NameEn"),prop:"name_en"},{default:o(()=>[u(i,{modelValue:a.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.name_en=l)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.NameAr"),prop:"name_ar"},{default:o(()=>[u(i,{modelValue:a.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.name_ar=l)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.Needs-Amount")},{default:o(()=>[u(n,{modelValue:a.value.amount_required,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.amount_required=l),"active-text":"Yes","inactive-text":"No",dir:"ltr",class:"mx-3"},null,8,["modelValue"])]),_:1},8,["label"]),a.value.amount_required?(d(),p(b,{key:0},[u(k,{"content-position":"left"},{default:o(()=>[B(V(t.$t("Products.Amount-Info")),1)]),_:1}),u(r,{label:t.$t("Products.Unit"),prop:"unit_id"},{default:o(()=>[u(_,{modelValue:a.value.unit_id,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.unit_id=l),placeholder:t.$t("Products.select-unit"),filterable:"",clearable:""},{default:o(()=>[(d(!0),p(b,null,g(q.value,l=>(d(),y(m,{key:l.id,label:l.name_en,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.Weight"),prop:"weight"},{default:o(()=>[u(i,{modelValue:a.value.weight,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.weight=l),type:"number",placeholder:t.$t("Products.select-weight")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.amount-Price"),prop:"amount_price"},{default:o(()=>[u(i,{modelValue:a.value.amount_price,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.amount_price=l),type:"number",placeholder:t.$t("Products.select-price")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):U("",!0),a.value.amount_required?U("",!0):(d(),y(r,{key:1,label:t.$t("Products.Price"),prop:"price"},{default:o(()=>[u(i,{modelValue:a.value.price,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.price=l),type:"number"},null,8,["modelValue"])]),_:1},8,["label"])),u(r,{label:t.$t("Products.Availability"),prop:"is_available"},{default:o(()=>[u(n,{modelValue:a.value.is_available,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.is_available=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.DescriptionEn"),prop:"description_en"},{default:o(()=>[u(i,{type:"textarea",modelValue:a.value.description_en,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.description_en=l)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.DescriptionAr"),prop:"description_ar"},{default:o(()=>[u(i,{type:"textarea",modelValue:a.value.description_ar,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.description_ar=l)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.Category"),prop:"category_id"},{default:o(()=>[u(_,{modelValue:a.value.category_id,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.category_id=l),filterable:"",clearable:"",placeholder:t.$t("Products.SelectCategory")},{default:o(()=>[(d(!0),p(b,null,g($.value,l=>(d(),y(m,{key:l.id,label:l.name_en||l.name_ar,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.brand"),prop:"brand_id"},{default:o(()=>[u(_,{modelValue:a.value.brand_id,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.brand_id=l),filterable:"",clearable:"",placeholder:"Select Brand"},{default:o(()=>[(d(!0),p(b,null,g(S.value,l=>(d(),y(m,{key:l.id,label:l.name_en,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.Currency"),prop:"currency_id"},{default:o(()=>[u(_,{modelValue:a.value.currency_id,"onUpdate:modelValue":e[12]||(e[12]=l=>a.value.currency_id=l),filterable:"",clearable:"",placeholder:t.$t("Products.SelectCurrency")},{default:o(()=>[(d(!0),p(b,null,g(L.value,l=>(d(),y(m,{key:l.id,label:F(l),value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.Country"),prop:"country_id"},{default:o(()=>[u(_,{modelValue:a.value.country_id,"onUpdate:modelValue":e[13]||(e[13]=l=>a.value.country_id=l),filterable:"",clearable:"",placeholder:t.$t("Products.SelectCountry")},{default:o(()=>[(d(!0),p(b,null,g(E.value,l=>(d(),y(m,{key:l.id,label:l.name_en||l.name_ar,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(r,{label:t.$t("Products.ParentProduct"),prop:"parent_id"},{default:o(()=>[u(_,{modelValue:a.value.parent_id,"onUpdate:modelValue":e[14]||(e[14]=l=>a.value.parent_id=l),clearable:"",placeholder:t.$t("Products.SelectParentProduct")},{default:o(()=>[u(m,{label:t.$t("Products.None"),value:null},null,8,["label"]),(d(!0),p(b,null,g(R.value,l=>(d(),y(m,{key:l.id,label:l.name_en,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a.value.images&&a.value.images.length?(d(),p("div",ae,[(d(!0),p(b,null,g(a.value.images,(l,H)=>(d(),p("img",{key:H,src:l.url?l.url:N(l.path),alt:"Product Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,te))),128))])):U("",!0),u(r,{label:t.$t("Products.Images"),prop:"images"},{default:o(()=>[u(J,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:5,"file-list":a.value.images,"list-type":"picture","on-change":T,"on-remove":W},{default:o(()=>[e[15]||(e[15]=h("i",{class:"el-icon-upload"},null,-1)),h("div",ue,V(t.$t("Products.DropFiles")),1)]),_:1,__:[15]},8,["file-list"])]),_:1},8,["label"]),u(r,null,{default:o(()=>[u(j,{type:"primary",onClick:z},{default:o(()=>[B(V(t.$t("Products.UpdateButton")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},de=K(oe,[["__scopeId","data-v-88e70f6b"]]);export{de as default};
