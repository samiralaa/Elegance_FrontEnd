import{_ as ve,z as _e,I as me,J as ge,K as pe,x as fe,y as he,u as f,B as ke,L as be,r as z,o as l,c,a,e as d,l as w,t as r,M as P,F as q,d as M,f as h,b as D,s as W,H as ye,n as $,m as we,g as Ce,i as Fe,E as m}from"./index-1a54cba5.js";import{$ as k}from"./slick-theme-71520487.js";const Se=["dir"],$e={class:"container"},xe={class:"product-details"},Ie={class:"product-title"},Te=["innerHTML"],ze={class:"price-block"},Pe={key:0,class:"price-old"},qe={class:"price-new"},Ae={class:"product-actions"},Ee=["title"],Ne={key:0,class:"sale-badge"},Re={key:0,class:"weight"},Me={class:"weight-container"},Be={class:"row g-4"},Le=["onClick"],Ve={class:"buttons-section"},De={key:0,class:"quantity-section"},Oe={class:"quantity-control"},He=["src"],Qe={class:"slider-wrapper"},je=["onClick"],Ue=["src"],Je={key:0,class:"children-products-section"},Ke={class:"title section-header d-flex align-items-center mb-4"},We={class:"mb-0"},Ge={class:"row g-3"},Xe={class:"product-card card border-0 h-100"},Ye={class:"position-relative overflow-hidden bg-light"},Ze=["src","alt"],et={key:0,class:"sale-badge"},tt={class:"product-actions d-flex justify-content-center gap-2 w-100"},st=["onClick","disabled"],at=["onClick","disabled"],ot=["onClick","title"],it={class:"card-body"},nt={class:"card-title"},rt={class:"price-container"},lt={key:0,class:"discount-badge"},ct={key:1,class:"price-old"},dt={class:"card-text card-price"},G=1,X=99,O="/default-image.jpg",ut={__name:"showProduct",setup(vt){const{locale:C,t:n}=_e(),Y=me(()=>C.value==="ar"?"rtl":"ltr"),Z=ge();pe();const b=fe(),H=he(),s=f({}),g=f(1),A=f(null),F=f(!1);f(0);const x=f(null),I=f(null),B=f(3),L=f(3),E=e=>e?`http://elegance_backend.test/public/storage/${e}`:O,Q=e=>{e.target.src=O},N=e=>{A.value=e,W(()=>{const t=document.querySelector(".main-image");t&&(t.src=E(e))})},ee=async()=>{var e;try{const t=await D.get(`http://elegance_backend.test/api/website/show/products/${Z.params.id}`);t.data.status&&(s.value=t.data.data,(e=s.value.images)!=null&&e.length&&(A.value=s.value.images[0].path,W(()=>{U(),de()})))}catch(t){console.error("Error fetching product:",t)}},te=async()=>{var e,t;try{const i={product_id:s.value.id,quantity:g.value,price:s.value.price};s.value.amounts&&(i.amount_id=s.value.amount_id);const u=await D.post("http://elegance_backend.test/api/cart-items",i,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});u.data.message&&(m({title:n("success"),message:u.data.message,type:"success"}),H.incrementCount(),await H.fetchCartCount())}catch(i){m({title:"❌",message:((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||n("add_to_cart_error")||"Login required to add to cart",type:"error"})}},j=async e=>{var t,i,u;try{const v={product_id:e.id,quantity:1,price:e.price},p=(t=JSON.parse(localStorage.getItem("auth_user")))==null?void 0:t.id;p&&(v.user_id=p),e.amounts&&(v.amount_id=e.amount_id);const T=await D.post("http://elegance_backend.test/api/cart-items",v,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});T.data.message&&m({title:n("success"),message:T.data.message,type:"success"})}catch(v){console.error("Error adding child product to cart:",v),m({title:"❌",message:((u=(i=v.response)==null?void 0:i.data)==null?void 0:u.message)||n("add_to_cart_error")||"Login required to add to cart",type:"error"})}},V=f(),se=(e,t)=>{V.value=e,s.value.amount_id=t.id,s.value.price=t.price},ae=()=>{V.value=null,s.value.amount_id=null,s.value.original_price},U=()=>{var u;const e=k(x.value),t=k(I.value);e.hasClass("slick-initialized")&&e.slick("unslick"),t.hasClass("slick-initialized")&&t.slick("unslick");const i=((u=s.value.images)==null?void 0:u.length)||0;L.value=i,B.value=i>=4?3:1,e.slick({dots:!1,centerMode:!0,centerPadding:"0px",slidesToShow:B.value,slidesToScroll:1,infinite:i>1,focusOnSelect:!0,rtl:C.value==="ar",asNavFor:t,afterChange:function(v){const p=s.value.images[v];p&&N(p.path)}}),t.slick({slidesToShow:1,slidesToScroll:1,infinite:i>1,fade:!0,arrows:!1,dots:!1,centerMode:!0,rtl:C.value==="ar",asNavFor:e,afterChange:function(v){const p=s.value.images[v];p&&N(p.path)}})},oe=()=>{const e=k(x.value),t=k(I.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickPrev"),t.slick("slickPrev"),J())},ie=()=>{const e=k(x.value),t=k(I.value);e.length&&e.hasClass("slick-initialized")&&(e.slick("slickNext"),t.slick("slickNext"),J())},J=()=>{const e=k(x.value);if(e.length&&e.hasClass("slick-initialized")){const i=e.find(".slick-current").find("img").attr("src").replace("http://elegance_backend.test/public/storage/","");N(i)}};ke(()=>{ee().then(U)}),be(()=>{const e=k(I.value),t=k(x.value);e.hasClass("slick-initialized")&&e.slick("unslick"),t.hasClass("slick-initialized")&&t.slick("unslick")});const R=e=>b.isInFavorites(e.id),ne=async e=>{try{if(R(e)){const t=b.favorites.find(i=>i.product_id===e.id);t&&(await b.removeFromFavorites(t.id),m({title:n("Removed From Favorites"),message:n("Product Removed From Favorites"),type:"success"}))}else await b.addToFavorites(e.id)&&m({title:n("Added To Favorites"),message:n("Product Added To Favorites"),type:"success"})}catch(t){console.error("Error toggling child favorites:",t),m({title:n("error"),message:t.message||n("failed_to_toggle_favorite"),type:"error"})}},re=()=>{g.value<X?g.value++:m({title:n("warning"),message:n("max_quantity_reached"),type:"warning"})},le=()=>{g.value>G?g.value--:m({title:n("warning"),message:n("min_quantity_reached"),type:"warning"})},ce=async()=>{try{if(F.value){const e=b.favorites.find(t=>t.product_id===s.value.id);e&&(await b.removeFromFavorites(e.id),F.value=!1,m({title:n("Removed From Favorites"),message:n("Product Removed From Favorites"),type:"success"}))}else await b.addToFavorites(s.value.id)&&(F.value=!0,m({title:n("Added To Favorites"),message:n("Product Added To Favorites"),type:"success"}))}catch(e){console.error("Error toggling favorites:",e),m({title:n("error"),message:e.message||n("failed_to_toggle_favorite"),type:"error"})}},de=()=>{F.value=b.isInFavorites(s.value.id)},ue=e=>{if(e.discount&&e.discount.length>0){const t=parseFloat(e.discount[0].discount_value),i=parseFloat(e.price);return(i-i*(t/100)).toFixed(2)}return e.price};return(e,t)=>{const i=z("fa"),u=z("el-button"),v=z("el-col"),p=z("el-row"),T=z("router-link");return l(),c(q,null,[t[5]||(t[5]=a("link",{href:"https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap",rel:"stylesheet"},null,-1)),d(ye),a("div",{class:"product-show",dir:Y.value},[a("div",$e,[d(p,{gutter:20,class:"product-container full-height-row flex-md-row flex-column-reverse"},{default:w(()=>[d(v,{xs:24,sm:24,md:12,lg:14},{default:w(()=>{var o,S;return[a("div",xe,[a("h1",Ie,r(P(C)==="ar"?s.value.name_ar:s.value.name_en),1),a("div",{innerHTML:P(C)==="ar"?s.value.description_ar:s.value.description_en,class:"description"},null,8,Te),a("div",ze,[s.value.old_price?(l(),c("span",Pe,r(s.value.old_price)+" "+r((o=s.value.currency)==null?void 0:o.name_en),1)):h("",!0),a("span",qe,r(s.value.price)+" "+r((S=s.value.currency)==null?void 0:S.name_en),1)]),a("div",Ae,[a("button",{onClick:t[0]||(t[0]=_=>ce(s.value)),class:$(["btn rounded-circle shadow-sm btn-light",F.value?"text-danger":""]),title:F.value?"Remove from favorites":"Add to favorites"},[d(i,{icon:F.value?"fas fa-heart":"far fa-heart",size:"xl"},null,8,["icon"])],10,Ee),s.value.is_available?h("",!0):(l(),c("div",Ne,r(e.$t("products.outOfStock")),1))]),s.value.amounts&&s.value.amounts.length>0?(l(),c("div",Re,[t[4]||(t[4]=a("h1",{class:"weight-title"},"Select Weight",-1)),a("div",{class:"reset",onClick:ae},[d(i,{icon:"rotate-right"}),t[3]||(t[3]=a("a",null,"reset",-1))]),a("div",Me,[a("div",Be,[(l(!0),c(q,null,M(s.value.amounts,(_,y)=>{var K;return l(),c("div",{key:_.id,class:$(["weight-item",{active:V.value===y}]),onClick:_t=>se(y,_)},[a("p",null,r(_.weight)+" "+r(_.unit.name_en)+" For "+r(_.price)+" "+r((K=s.value.currency)==null?void 0:K.name_en),1)],10,Le)}),128))])])])):h("",!0),a("div",Ve,[d(u,{class:"add-to-cart btn",disabled:!s.value.is_available,type:"primary",size:"large",round:"",onClick:te},{default:w(()=>[we(r(e.$t("products.addToCart")),1)]),_:1},8,["disabled"]),s.value.is_available?(l(),c("div",De,[a("div",Oe,[d(u,{size:"small",onClick:le,disabled:g.value<=G,class:"qty-btn"},{default:w(()=>[d(i,{icon:"minus"})]),_:1},8,["disabled"]),Ce(a("input",{class:"qty-number",type:"number",min:"1",max:"99","onUpdate:modelValue":t[1]||(t[1]=_=>g.value=_),onInput:t[2]||(t[2]=_=>g.value=Math.min(g.value))},null,544),[[Fe,g.value,void 0,{number:!0}]]),d(u,{size:"small",onClick:re,disabled:g.value>=X,class:"qty-btn"},{default:w(()=>[d(i,{icon:"plus"})]),_:1},8,["disabled"])])])):h("",!0)])])]}),_:1}),d(v,{xs:24,sm:24,md:12,lg:10,class:"image-col"},{default:w(()=>[a("div",{class:"image-wrapper",ref_key:"main",ref:I},[(l(!0),c(q,null,M(s.value.images,(o,S)=>(l(),c("div",{key:o.id,class:"slide"},[a("img",{src:E(A.value),class:"main-image",onError:Q},null,40,He)]))),128))],512),a("div",Qe,[L.value>1?(l(),c("button",{key:0,class:"btn nav-button left",onClick:oe},[d(i,{icon:"arrow-left"})])):h("",!0),a("div",{class:$(["slider-container",{"centered-slides":B.value<3}])},[a("div",{class:"slider",ref_key:"slider",ref:x},[(l(!0),c(q,null,M(s.value.images,(o,S)=>(l(),c("div",{key:o.id,class:"slide",onClick:_=>N(o.path)},[a("img",{src:E(o.path),class:$({active:A.value===o.path}),onError:Q},null,42,Ue)],8,je))),128))],512)],2),L.value>1?(l(),c("button",{key:1,class:"btn nav-button right",onClick:ie},[d(i,{icon:"arrow-right"})])):h("",!0)])]),_:1})]),_:1}),s.value.children&&s.value.children.length>0?(l(),c("div",Je,[a("div",Ke,[d(i,{class:"fa-icon me-2",icon:["fas","shopping-basket"]}),a("h2",We,r(P(n)("products.relatedProducts")),1)]),a("div",Ge,[(l(!0),c(q,null,M(s.value.children,o=>{var S,_;return l(),c("div",{class:"col-6 col-md-4 col-lg-3",key:o.id},[a("div",Xe,[a("div",Ye,[d(T,{to:`/read/products/${s.value.id}`},{default:w(()=>{var y;return[a("img",{src:(y=o.images)!=null&&y.length?E(o.images[0].path):O,alt:P(C)==="ar"?o.name_ar:o.name_en,class:"card-img-top product-img"},null,8,Ze)]}),_:2},1032,["to"]),o.is_available?h("",!0):(l(),c("div",et,r(e.$t("products.outOfStock")),1)),a("div",tt,[d(T,{to:`/read/products/${o.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:w(()=>[d(i,{icon:"eye"})]),_:2},1032,["to"]),a("button",{onClick:y=>j(o),class:$(["btn btn-light shadow-sm",{disabled:!o.is_available}]),disabled:!o.is_available},r(e.$t("home.add-to-cart")),11,st),a("button",{onClick:y=>j(o),class:$(["d-none btn rounded-circle btn-light shadow-sm",{disabled:!o.is_available}]),disabled:!o.is_available},[d(i,{icon:"cart-plus"})],10,at),a("button",{onClick:y=>ne(o),class:$(["btn rounded-circle shadow-sm btn-light",R(o)?"text-danger":""]),title:R(o)?"Remove from favorites":"Add to favorites"},[d(i,{icon:R(o)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,ot)])]),a("div",it,[a("h5",nt,r(P(C)==="ar"?o.name_ar:o.name_en),1),a("div",rt,[o.discount&&o.discount.length>0?(l(),c("span",lt," -"+r(o.discount[0].discount_value),1)):h("",!0),o.discount&&o.discount.length>0?(l(),c("span",ct,r(o.old_price)+" "+r(((S=o.currency)==null?void 0:S.name_en)||"AED"),1)):h("",!0),a("span",dt,r(ue(o))+" "+r(((_=o.currency)==null?void 0:_.name_en)||"AED"),1)])])])])}),128))])])):h("",!0)])],8,Se)],64)}}},pt=ve(ut,[["__scopeId","data-v-f271c480"]]);export{pt as default};
