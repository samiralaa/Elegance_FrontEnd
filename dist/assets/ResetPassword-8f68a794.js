import{_ as m,H as f,b as g,o as a,c as l,a as e,t as d,g as k,w,m as c,f as h,l as u}from"./index-260107d7.js";const _={components:{Header:f},data(){return{email:"",password:"",password_confirmation:"",loading:!1,error:null,success:null,showPassword:!1,showConfirmPassword:!1}},mounted(){const t=localStorage.getItem("user");if(t)try{const s=JSON.parse(t);this.email=s.email||""}catch{this.email=localStorage.getItem("user_email")||""}else this.email=localStorage.getItem("user_email")||""},created(){const t=new URLSearchParams(window.location.search),s=t.get("email"),r=t.get("token");if(!s||!r){this.$router.push("/register");return}this.token=r,this.email=s},methods:{async resetPassword(){var t,s;if(this.error=null,this.success=null,this.password!==this.password_confirmation){this.error=this.$t("profile.passwordsDoNotMatch");return}if(this.password.length<8){this.error=this.$t("profile.passwordTooShort");return}if(console.log("Email being sent:",this.email),!this.email){this.error="Email is required but not available";return}this.loading=!0;try{const r=await g.post("api/reset-password",{email:this.email,password:this.password,password_confirmation:this.password_confirmation});if(r.data.status&&r.data.data){const n=r.data.data;localStorage.setItem("auth_token",n.token),localStorage.setItem("auth_user",JSON.stringify(n.user)),this.$store&&this.$store.commit&&(this.$store.commit("auth/SET_AUTH",n),await this.$store.dispatch("cart/loadCart")),this.success=r.data.message||this.$t("profile.passwordResetSuccess"),setTimeout(()=>{this.$router.push("/")},1500)}else this.error=r.data.message||this.$t("profile.passwordResetFailed")}catch(r){this.error=((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.message)||this.$t("profile.passwordResetFailed")}finally{this.loading=!1}},goBackToProfile(){this.$router.push({name:"Profile"})}}},P={class:"reset-password-outer"},v={class:"reset-password-card"},b={class:"reset-password-header"},y={class:"form-group password-group"},S={for:"password"},M={class:"password-input-wrapper"},B=["type","placeholder"],C={key:0,width:"20",height:"20",fill:"none",viewBox:"0 0 24 24"},T={key:1,width:"20",height:"20",fill:"none",viewBox:"0 0 24 24"},x={class:"form-group password-group"},D={for:"password_confirmation"},I={class:"password-input-wrapper"},N=["type","placeholder"],R={key:0,width:"20",height:"20",fill:"none",viewBox:"0 0 24 24"},A={key:1,width:"20",height:"20",fill:"none",viewBox:"0 0 24 24"},V=["disabled"],E={key:0,class:"loader-small"},H={key:0,class:"error-message"},U={key:1,class:"success-message"},$={class:"back-to-profile"};function q(t,s,r,n,o,p){return a(),l("div",P,[e("div",v,[e("div",b,[e("h2",null,d(t.$t("profile.resetPassword")),1),e("p",null,d(t.$t("profile.resetPasswordDesc")),1)]),e("form",{onSubmit:s[4]||(s[4]=k((...i)=>p.resetPassword&&p.resetPassword(...i),["prevent"])),class:"reset-password-form"},[e("div",y,[e("label",S,d(t.$t("profile.newPassword")),1),e("div",M,[w(e("input",{type:o.showPassword?"text":"password","onUpdate:modelValue":s[0]||(s[0]=i=>o.password=i),id:"password",required:"",placeholder:t.$t("profile.newPasswordPlaceholder")},null,8,B),[[c,o.password]]),e("button",{type:"button",class:"toggle-password",onClick:s[1]||(s[1]=i=>o.showPassword=!o.showPassword),tabindex:"-1"},[o.showPassword?(a(),l("svg",C,s[6]||(s[6]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z",stroke:"#667eea","stroke-width":"2"},null,-1),e("circle",{cx:"12",cy:"12",r:"3",stroke:"#667eea","stroke-width":"2"},null,-1)]))):(a(),l("svg",T,s[7]||(s[7]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0112 19c-7 0-11-7-11-7a21.77 21.77 0 015.06-6.06M9.88 9.88A3 3 0 0112 9c1.66 0 3 1.34 3 3 0 .52-.13 1.01-.35 1.43",stroke:"#667eea","stroke-width":"2"},null,-1),e("path",{d:"M1 1l22 22",stroke:"#667eea","stroke-width":"2"},null,-1)])))])])]),e("div",x,[e("label",D,d(t.$t("profile.confirmPassword")),1),e("div",I,[w(e("input",{type:o.showConfirmPassword?"text":"password","onUpdate:modelValue":s[2]||(s[2]=i=>o.password_confirmation=i),id:"password_confirmation",required:"",placeholder:t.$t("profile.confirmPasswordPlaceholder")},null,8,N),[[c,o.password_confirmation]]),e("button",{type:"button",class:"toggle-password",onClick:s[3]||(s[3]=i=>o.showConfirmPassword=!o.showConfirmPassword),tabindex:"-1"},[o.showConfirmPassword?(a(),l("svg",R,s[8]||(s[8]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z",stroke:"#667eea","stroke-width":"2"},null,-1),e("circle",{cx:"12",cy:"12",r:"3",stroke:"#667eea","stroke-width":"2"},null,-1)]))):(a(),l("svg",A,s[9]||(s[9]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0112 19c-7 0-11-7-11-7a21.77 21.77 0 015.06-6.06M9.88 9.88A3 3 0 0112 9c1.66 0 3 1.34 3 3 0 .52-.13 1.01-.35 1.43",stroke:"#667eea","stroke-width":"2"},null,-1),e("path",{d:"M1 1l22 22",stroke:"#667eea","stroke-width":"2"},null,-1)])))])])]),e("button",{type:"submit",disabled:o.loading,class:"submit-btn"},[o.loading?(a(),l("span",E)):h("",!0),u(" "+d(o.loading?t.$t("profile.loading"):t.$t("profile.submit")),1)],8,V),o.error?(a(),l("div",H,d(o.error),1)):h("",!0),o.success?(a(),l("div",U,d(o.success),1)):h("",!0)],32),e("div",$,[e("button",{onClick:s[5]||(s[5]=(...i)=>p.goBackToProfile&&p.goBackToProfile(...i)),class:"back-btn"},[s[10]||(s[10]=e("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),u(" "+d(t.$t("profile.backToProfile")),1)])])])])}const j=m(_,[["render",q],["__scopeId","data-v-2d5dfb2a"]]);export{j as default};
