import{_ as b,b as m,W as v,r as _,o as l,c,a as s,t as n,f as g,g as y,k as w,w as p,v as f,e as C,m as k,F as M,d as B,i as S}from"./index-fb9faeb8.js";const E={name:"EditCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands(),this.fetchCategory()},methods:{async fetchBrands(){try{const a=JSON.parse(localStorage.getItem("tokenData"));a!=null&&a.token&&(m.defaults.headers.common.Authorization=`Bearer ${a.token}`);const e=await m.get("https://backend.webenia.org/api/brands");if(e.data.status){const i=e.data.data;this.brands=Array.isArray(i)?i:[i]}else throw new Error(e.data.message||"Failed to fetch brands")}catch(a){console.error("Error fetching brands:",a),v.error("Failed to load brands")}},async fetchCategory(){var a,e;this.loading=!0;try{const i=JSON.parse(localStorage.getItem("tokenData"));i!=null&&i.token&&(m.defaults.headers.common.Authorization=`Bearer ${i.token}`);const u=this.$route.params.id,t=await m.get(`https://backend.webenia.org/api/categories/${u}`);if(t.data.status&&t.data.data){const r=t.data.data;this.form={name:r.name_en||"",name_ar:r.name_ar||"",description:r.description_en||"",description_ar:r.description_ar||"",brand_id:r.brand_id||"",image:null},r.image&&(this.imagePreview=r.image)}else throw new Error(t.data.message||"Failed to fetch category")}catch(i){this.errorMessage=((e=(a=i.response)==null?void 0:a.data)==null?void 0:e.message)||i.message||"An error occurred while fetching the category."}finally{this.loading=!1}},onFileChange(a){const e=a.target.files[0];e?(this.form.image=e,this.imagePreview=URL.createObjectURL(e)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var a,e,i,u,t;this.successMessage="",this.errorMessage="",this.loading=!0;try{const r=new FormData;r.append("name_en",this.form.name),r.append("name_ar",this.form.name_ar),r.append("description_en",this.form.description),r.append("description_ar",this.form.description_ar),r.append("brand_id",this.form.brand_id),this.form.image&&r.append("image",this.form.image);const d=JSON.parse(localStorage.getItem("tokenData"));d!=null&&d.token&&(m.defaults.headers.common.Authorization=`Bearer ${d.token}`);const h=this.$route.params.id,o=await m.post(`https://backend.webenia.org/api/categories/${h}`,r,{headers:{"Content-Type":"multipart/form-data"}});if((a=o.data)!=null&&a.status&&((e=o.data)!=null&&e.data))this.loading=!1,this.successMessage="Category updated successfully!",setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((i=o.data)==null?void 0:i.message)||"Failed to update category")}catch(r){this.loading=!1,this.errorMessage=((t=(u=r.response)==null?void 0:u.data)==null?void 0:t.message)||r.message||"An error occurred while updating the category."}}}},F={class:"category-edit"},V={class:"form-card"},A={class:"form-title"},I={key:0,class:"loading-overlay"},N={key:1,class:"success-message"},P={key:2,class:"error-message"},U={class:"form-group"},D={class:"form-group"},q={class:"form-group"},z={class:"form-group"},O={class:"form-group"},J={class:"form-group"},L=["value"],T={class:"form-group"},R={class:"file-input-wrapper"},j={key:0,class:"image-preview-container"},x={class:"preview-title"},W={class:"image-preview"},G=["src"],H={type:"submit",class:"submit-button"};function K(a,e,i,u,t,r){const d=_("el-option"),h=_("el-select");return l(),c("div",F,[s("div",V,[s("h2",A,n(a.$t("Categories.EditCategory")),1),t.loading?(l(),c("div",I,e[7]||(e[7]=[s("span",{class:"spinner"},null,-1)]))):g("",!0),t.successMessage?(l(),c("div",N,n(t.successMessage),1)):g("",!0),t.errorMessage?(l(),c("div",P,n(t.errorMessage),1)):g("",!0),s("form",{onSubmit:e[6]||(e[6]=y((...o)=>r.submitCategory&&r.submitCategory(...o),["prevent"])),style:w(t.loading?"pointer-events:none;opacity:0.5;":"")},[s("div",U,[s("label",null,n(a.$t("Categories.NameEn")),1),p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.form.name=o),required:"",class:"form-input"},null,512),[[f,t.form.name]])]),s("div",D,[s("label",null,n(a.$t("Categories.NameAr")),1),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.form.name_ar=o),required:"",class:"form-input"},null,512),[[f,t.form.name_ar]])]),s("div",q,[s("label",null,n(a.$t("Categories.DescriptionEn")),1),p(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.form.description=o),required:"",class:"form-input form-textarea"},null,512),[[f,t.form.description]])]),s("div",z,[s("label",null,n(a.$t("Categories.DescriptionAr")),1),p(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.form.description_ar=o),required:"",class:"form-input form-textarea"},null,512),[[f,t.form.description_ar]])]),s("div",O,[s("label",null,n(a.$t("Categories.Brand")),1),C(h,{modelValue:t.form.brand_id,"onUpdate:modelValue":e[4]||(e[4]=o=>t.form.brand_id=o),placeholder:a.$t("Categories.SelectBrand"),filterable:"",clearable:"",class:"form-input"},{default:k(()=>[(l(!0),c(M,null,B(t.brands,o=>(l(),S(d,{key:o.id,label:o.name_en,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),s("div",J,[e[8]||(e[8]=s("label",null,"Selected Brand ID",-1)),s("input",{class:"form-input",value:t.form.brand_id,readonly:""},null,8,L)]),s("div",T,[s("label",null,n(a.$t("Categories.Image")),1),s("div",R,[s("input",{type:"file",onChange:e[5]||(e[5]=(...o)=>r.onFileChange&&r.onFileChange(...o)),accept:"image/*",class:"form-input file-input"},null,32)])]),t.imagePreview?(l(),c("div",j,[s("p",x,n(a.$t("Categories.ImagePreview")),1),s("div",W,[s("img",{src:t.imagePreview,alt:"Image Preview"},null,8,G)])])):g("",!0),s("button",H,n(a.$t("Categories.UpdateButton")),1)],36)])])}const X=b(E,[["render",K],["__scopeId","data-v-aa36fa49"]]);export{X as default};
