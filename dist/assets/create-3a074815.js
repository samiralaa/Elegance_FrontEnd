import{_ as v,b as u,r as h,o as l,c as m,a as s,t as i,f as p,g as b,k as y,w as g,v as f,e as w,m as C,F as k,d as B,i as M}from"./index-b24dc877.js";const V={name:"CreateCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const t=JSON.parse(localStorage.getItem("tokenData"));t!=null&&t.token&&(u.defaults.headers.common.Authorization=`Bearer ${t.token}`);const e=await u.get("https://backend.webenia.org/api/brands");if(e.data.status){const n=e.data.data;this.brands=Array.isArray(n)?n:[n]}else throw new Error(e.data.message||"Failed to fetch brands")}catch(t){console.error("Error fetching brands:",t),alert("Failed to load brands")}},onFileChange(t){const e=t.target.files[0];e?(this.form.image=e,this.imagePreview=URL.createObjectURL(e)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var t,e,n,_,r;this.successMessage="",this.errorMessage="",this.loading=!0;try{const o=new FormData;o.append("name_en",this.form.name),o.append("name_ar",this.form.name_ar),o.append("description_en",this.form.description),o.append("description_ar",this.form.description_ar),o.append("brand_id",this.form.brand_id),this.form.image&&o.append("image",this.form.image);const d=JSON.parse(localStorage.getItem("tokenData"));d!=null&&d.token&&(u.defaults.headers.common.Authorization=`Bearer ${d.token}`);const c=await u.post("https://backend.webenia.org/api/categories",o,{headers:{"Content-Type":"multipart/form-data"}});if((t=c.data)!=null&&t.status&&((e=c.data)!=null&&e.data))this.loading=!1,this.successMessage="Category created successfully!",this.form={name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},this.imagePreview=null,setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((n=c.data)==null?void 0:n.message)||"Failed to create category")}catch(o){this.loading=!1,this.errorMessage=((r=(_=o.response)==null?void 0:_.data)==null?void 0:r.message)||o.message||"An error occurred while creating the category."}}}},F={class:"category-create"},S={class:"form-card"},A={class:"form-title"},P={key:0,class:"loading-overlay"},D={key:1,class:"success-message"},I={key:2,class:"error-message"},N={class:"form-group"},U={class:"form-group"},E={class:"form-group"},q={class:"form-group"},z={class:"form-group"},L={class:"form-group"},O=["value"],T={class:"form-group"},J={class:"file-input-wrapper"},R={key:0,class:"image-preview-container"},j={class:"preview-title"},x={class:"image-preview"},G=["src"],H={type:"submit",class:"submit-button"};function K(t,e,n,_,r,o){const d=h("el-option"),c=h("el-select");return l(),m("div",F,[s("div",S,[s("h2",A,i(t.$t("Categories.AddCategory")),1),r.loading?(l(),m("div",P,e[7]||(e[7]=[s("span",{class:"spinner"},null,-1)]))):p("",!0),r.successMessage?(l(),m("div",D,i(r.successMessage),1)):p("",!0),r.errorMessage?(l(),m("div",I,i(r.errorMessage),1)):p("",!0),s("form",{onSubmit:e[6]||(e[6]=b((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"])),style:y(r.loading?"pointer-events:none;opacity:0.5;":"")},[s("div",N,[s("label",null,i(t.$t("Categories.NameEn")),1),g(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.form.name=a),required:"",class:"form-input"},null,512),[[f,r.form.name]])]),s("div",U,[s("label",null,i(t.$t("Categories.NameAr")),1),g(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>r.form.name_ar=a),required:"",class:"form-input"},null,512),[[f,r.form.name_ar]])]),s("div",E,[s("label",null,i(t.$t("Categories.DescriptionEn")),1),g(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>r.form.description=a),required:"",class:"form-input form-textarea"},null,512),[[f,r.form.description]])]),s("div",q,[s("label",null,i(t.$t("Categories.DescriptionAr")),1),g(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>r.form.description_ar=a),required:"",class:"form-input form-textarea"},null,512),[[f,r.form.description_ar]])]),s("div",z,[s("label",null,i(t.$t("Categories.Brand")),1),w(c,{modelValue:r.form.brand_id,"onUpdate:modelValue":e[4]||(e[4]=a=>r.form.brand_id=a),placeholder:t.$t("Categories.SelectBrand"),filterable:"",clearable:"",class:"form-input"},{default:C(()=>[(l(!0),m(k,null,B(r.brands,a=>(l(),M(d,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),s("div",L,[e[8]||(e[8]=s("label",null,"Selected Brand ID",-1)),s("input",{class:"form-input",value:r.form.brand_id,readonly:""},null,8,O)]),s("div",T,[s("label",null,i(t.$t("Categories.Image")),1),s("div",J,[s("input",{type:"file",onChange:e[5]||(e[5]=(...a)=>o.onFileChange&&o.onFileChange(...a)),accept:"image/*",required:"",class:"form-input file-input"},null,32)])]),r.imagePreview?(l(),m("div",R,[s("p",j,i(t.$t("Categories.ImagePreview")),1),s("div",x,[s("img",{src:r.imagePreview,alt:"Image Preview"},null,8,G)])])):p("",!0),s("button",H,i(t.$t("Categories.CreateButton")),1)],36)])])}const W=v(V,[["render",K],["__scopeId","data-v-21d22e43"]]);export{W as default};
