import{_ as J,B as j,K as x,x as u,y as K,C as G,N as D,r as N,o as l,c as d,e as _,a as t,t as n,g as Q,D as C,F as k,d as V,w,v as A,f as F,b as S,H as W,l as X,ae as Y,p as T,n as Z,E as m}from"./index-dc530aff.js";const ee={class:"axil-breadcrumb-area mt-5"},te={class:"container"},se={class:"row align-items-center"},ae={class:"col-lg-6 col-md-8"},oe={class:"inner"},re={class:"title"},ie=["dir"],ne={class:"container"},ce={class:"filter col-12"},le={class:"sidebar"},de={class:"sidebar-container"},ue={class:"sidebar-title"},ve={class:"checkbox-container"},me=["value"],_e={class:"sidebar-title"},ge={class:"price-range"},pe=["min","max"],he=["min","max"],fe={class:"price-values"},be={class:"products-grid"},ye={class:"image-container mb-3 bg-light rounded"},xe=["src","alt"],Ce={key:0,class:"sale-badge"},ke={class:"product-actions d-flex justify-content-center gap-5 w-100"},we=["onClick","title"],Fe={class:"card-body"},Se={class:"card-title"},Le={class:"price-container"},Pe={class:"card-text card-price"},$e={class:"addToCart-btn"},Ee=["disabled","onClick"],Ie={__name:"ProductListing",setup(De){const{locale:L,t:c}=j(),U=x(()=>L.value==="ar"?"rtl":"ltr"),P=u([]),$=u([]);u(!1),u("");const g=u([]),r=u({min:0,max:2e3}),v={min:0,max:2e3},p=u(!1),h=K(),E=()=>x(()=>{const s=localStorage.getItem("selectedCurrency");return s?JSON.parse(s).code:"AED"}).value,B=(e,s,i)=>{const o={AED:1,USD:.2724795640326976};return s===i?parseFloat(e):o[i]?parseFloat((e*o[i]).toFixed(2)):parseFloat(e)},b=()=>{p.value=!p.value;const e=document.querySelector(".sidebar"),s=document.body;e&&(e.classList.toggle("active",p.value),e.classList.contains("active")?s.classList.add("no-scroll"):s.classList.remove("no-scroll"))},q=e=>`https://backend.webenia.org/public/storage/${e}`,f=e=>h.favorites.some(s=>s.product_id===e),M=e=>{const s=h.favorites.find(i=>i.product_id===e);return s?s.favorite_id||s.id:null},O=async e=>{var s,i;try{if(f(e.id)){const o=M(e.id);o&&(await h.removeFromFavorites(o),m({title:c("success"),message:c("favorite_removed")||"Product removed from favorites",type:"success"}))}else{const o=await h.addToFavorites(e.id);m({title:c("success"),message:o.message||c("favorite_added")||"Product added to favorites",type:"success"})}}catch(o){console.error("Favorite error:",o),m({title:c("error"),message:((i=(s=o.response)==null?void 0:s.data)==null?void 0:i.message)||c("login_required_favorite")||"Login required to favorite product",type:"error"})}},R=async()=>{try{const e=await S.get("https://backend.webenia.org/api/website");P.value=e.data.data||[]}catch(e){console.error("Error loading categories",e)}},I=async()=>{try{const e=await S.get("https://backend.webenia.org/api/all/products");$.value=e.data.data||[]}catch(e){console.error("Error loading products",e)}},z=async e=>{var s,i;try{const o=JSON.parse(localStorage.getItem("selectedCurrency"))||{code:"USD"},a=await S.post("https://backend.webenia.org/api/cart-items",{product_id:e.id,quantity:1,price:parseFloat(e.price)},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Currency:o.code}});a.data.status?m({title:c("success"),message:a.data.message,type:"success"}):m({title:c("error"),message:a.data.message,type:"error"})}catch(o){console.error("Error adding to cart:",o),m({title:c("error"),message:(i=(s=o.response)==null?void 0:s.data)==null?void 0:i.message,type:"error"})}};G(()=>{R(),I(),window.addEventListener("currency-changed",()=>{I(),E()})});const H=x(()=>$.value.filter(e=>{const s=g.value.length===0||g.value.includes(e.category_id),i=r.value.min===v.min&&r.value.max===v.max,o=B(e.price,e.currency_code||"AED",currencyCode.value),a=i?!0:o>=r.value.min&&o<=r.value.max;return s&&a}));return D(()=>r.value.min,e=>{e>r.value.max&&(r.value.min=r.value.max)}),D(()=>r.value.max,e=>{e<r.value.min&&(r.value.max=r.value.min)}),(e,s)=>{const i=N("router-link"),o=N("fa");return l(),d(k,null,[_(W),t("div",ee,[t("div",te,[t("div",se,[t("div",ae,[t("div",oe,[t("h1",re,n(e.$t("products.title")),1)])])])])]),t("div",{class:"shop-container",dir:U.value},[t("div",ne,[t("div",ce,[t("a",{href:"#",onClick:Q(b,["prevent"])},n(e.$t("products.filter")),1)]),t("aside",le,[t("div",de,[t("button",{class:"close-btn",onClick:b},"Ã—"),t("h3",ue,n(C(c)("products.categories")),1),s[4]||(s[4]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),(l(!0),d(k,null,V(P.value,a=>(l(),d("div",{key:a.id,class:"filter-item"},[t("label",ve,[X(n(e.$i18n.locale==="ar"?a.name_ar:a.name_en)+" ",1),w(t("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=y=>g.value=y),value:a.id},null,8,me),[[Y,g.value]]),s[3]||(s[3]=t("span",{class:"checkmark"},null,-1))])]))),128)),t("h3",_e,n(C(c)("products.price")),1),s[5]||(s[5]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),t("div",ge,[w(t("input",{type:"range","onUpdate:modelValue":s[1]||(s[1]=a=>r.value.min=a),min:v.min,max:v.max},null,8,pe),[[A,r.value.min,void 0,{number:!0}]]),w(t("input",{type:"range","onUpdate:modelValue":s[2]||(s[2]=a=>r.value.max=a),min:v.min,max:v.max},null,8,he),[[A,r.value.max,void 0,{number:!0}]]),t("div",fe,[t("span",null,n(r.value.min)+" - "+n(r.value.max)+" "+n(E()),1)])])])]),p.value?(l(),d("div",{key:0,class:"overlay",onClick:b})):F("",!0),t("section",be,[(l(!0),d(k,null,V(H.value,a=>(l(),d("div",{key:a.id,class:"product-card"},[t("div",ye,[_(i,{to:`/read/products/${a.id}`},{default:T(()=>[a.images&&a.images.length?(l(),d("img",{key:0,src:q(a.images[0].path),alt:a.name},null,8,xe)):F("",!0)]),_:2},1032,["to"]),a.is_available?F("",!0):(l(),d("div",Ce,n(e.$t("products.outOfStock")),1)),t("div",ke,[_(i,{to:`/read/products/${a.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:T(()=>[_(o,{icon:"eye"})]),_:2},1032,["to"]),t("button",{onClick:y=>O(a),class:Z(["btn rounded-circle shadow-sm btn-light",f(a.id)?"text-danger":""]),title:f(a.id)?"Remove from favorites":"Add to favorites"},[_(o,{icon:f(a.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,we)])]),t("div",Fe,[t("h5",Se,n(C(L)==="ar"?a.name_ar:a.name_en),1),t("div",Le,[t("span",Pe,n(a.converted_price)+" "+n(a.currency_code),1)])]),t("div",$e,[t("button",{disabled:!a.is_available,onClick:y=>z(a),class:"btn"},n(e.$t("products.addToCart")),9,Ee)])]))),128))])])],8,ie)],64)}}},Ve=J(Ie,[["__scopeId","data-v-9cdbe4df"]]);export{Ve as default};
