import{_ as M,D as R,y as k,E as T,r as n,a5 as x,o as f,c as $,a as g,t as i,e as t,p as a,m as b,G as _,a2 as z,w as J,k as w,a6 as D,a0 as L,a1 as O,b as m,V as p,a4 as U}from"./index-e6d81d92.js";const P={class:"categories-container"},W={class:"header"},Y={class:"image-error"},j={key:1,class:"image-error"},q={dir:"rtl"},H={dir:"rtl"},v="https://backend.webenia.org",K={__name:"index",setup(Q){const y=R(),c=k([]),d=k(!1),C=`${v}/api/categories`,A=async()=>{d.value=!0;try{const e=JSON.parse(localStorage.getItem("tokenData"));if(!e||!e.token)throw new Error("Authentication token not found");m.defaults.headers.common.Authorization=`Bearer ${e.token}`;const s=await m.get(C);s.data.status===!0?(c.value=s.data.data,console.log("Categories fetched successfully:",c.value)):p.error(s.data.message||"Failed to fetch categories")}catch(e){console.error("Fetch categories error:",e),e instanceof SyntaxError?p.error("Invalid token format"):p.error(e.message||"Failed to fetch categories")}finally{d.value=!1}},B=()=>{y.push("/categories/create")},E=e=>{y.push(`/categories/edit/${e.id}`)},N=async e=>{try{if(await U.confirm("Are you sure you want to delete this category?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"})==="confirm"){d.value=!0;const r=JSON.parse(localStorage.getItem("tokenData"));if(!r||!r.token)throw new Error("Authentication token not found");m.defaults.headers.common.Authorization=`Bearer ${r.token}`;const u=await m.delete(`${C}/${e.id}`);if(u.data.status==="success")p.success("Category deleted successfully"),c.value=c.value.filter(h=>h.id!==e.id);else throw new Error(u.data.message||"Failed to delete category")}}catch(s){s!=="cancel"&&(console.error("Delete category error:",s),p.error(s.message||"Failed to delete category"))}finally{d.value=!1}};return T(()=>{A()}),(e,s)=>{const r=n("el-button"),u=n("el-icon"),h=n("el-image"),l=n("el-table-column"),S=n("el-button-group"),I=n("el-table"),F=n("el-card"),V=x("loading");return f(),$("div",P,[g("div",W,[g("h2",null,i(e.$t("Categories.Categories")),1),t(r,{type:"primary",icon:_(z),onClick:B},{default:a(()=>[b(i(e.$t("Categories.AddCategory")),1)]),_:1},8,["icon"])]),t(F,{class:"categories-table"},{default:a(()=>[J((f(),w(I,{data:c.value,style:{width:"100%"}},{default:a(()=>[t(l,{label:e.$t("Categories.Image"),width:"120"},{default:a(({row:o})=>[o.images&&o.images.length>0?(f(),w(h,{key:0,src:`${v}/public/storage/${o.images[0].path}`,fit:"cover",class:"category-image","preview-src-list":[`${v}/${o.images[0].path}`],"initial-index":0,"preview-teleported":""},{error:a(()=>[g("div",Y,[t(u,null,{default:a(()=>[t(_(D))]),_:1})])]),_:2},1032,["src","preview-src-list"])):(f(),$("div",j,[t(u,null,{default:a(()=>[t(_(D))]),_:1})]))]),_:1},8,["label"]),t(l,{prop:"name_en",label:e.$t("Categories.Categories")},null,8,["label"]),t(l,{prop:"name_ar",label:e.$t("Categories.name")},{default:a(({row:o})=>[g("div",q,i(o.name_ar||"N/A"),1)]),_:1},8,["label"]),t(l,{prop:"brand.name_en",label:e.$t("Categories.Brand")},null,8,["label"]),t(l,{prop:"description_en",label:e.$t("Categories.DescriptionEn")},null,8,["label"]),t(l,{prop:"description_ar",label:e.$t("Categories.DescriptionAr")},{default:a(({row:o})=>[g("div",H,i(o.description_ar||"N/A"),1)]),_:1},8,["label"]),t(l,{label:e.$t("Categories.Actions"),width:"200"},{default:a(({row:o})=>[t(S,null,{default:a(()=>[t(r,{type:"warning",icon:_(L),onClick:G=>E(o)},{default:a(()=>[b(i(e.$t("Global.Edit")),1)]),_:2},1032,["icon","onClick"]),t(r,{type:"danger",icon:_(O),onClick:G=>N(o)},{default:a(()=>[b(i(e.$t("Global.Delete")),1)]),_:2},1032,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[V,d.value]])]),_:1})])}}},Z=M(K,[["__scopeId","data-v-435ce16c"]]);export{Z as default};
