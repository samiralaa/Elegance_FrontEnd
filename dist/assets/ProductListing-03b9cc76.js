import{_ as q,D as H,u as d,x as O,z as j,G,r as D,o as r,c as l,e as m,a as t,t as o,w as J,L as u,F,d as E,g as P,i as S,f as h,l as k,b as V,H as K,m as I,ab as Q,n as W,ac as X,ad as Y,E as Z}from"./index-f73fdb68.js";const ee={class:"axil-breadcrumb-area mt-5"},se={class:"container"},te={class:"row align-items-center"},ae={class:"col-lg-6 col-md-8"},oe={class:"inner"},ie={class:"title"},ne=["dir"],re={class:"container"},le={class:"filter col-12"},ce={class:"sidebar"},de={class:"sidebar-container"},ue={class:"sidebar-title"},ve={class:"checkbox-container"},me=["value"],_e={class:"sidebar-title"},ge={class:"price-range"},he=["min","max"],be=["min","max"],pe={class:"price-values"},fe={class:"products-grid"},ye={class:"image-container mb-3 bg-light rounded"},ke=["src","alt"],xe={key:1,class:"sale-badge"},we={class:"product-actions d-flex justify-content-center gap-5 w-100"},Ce=["onClick","title"],Fe={class:"card-body"},Pe={class:"card-title"},Ve={class:"price-container"},Le={key:0,class:"discount-badge"},$e={key:1,class:"price-old"},De={class:"card-text card-price"},Ee={class:"addToCart-btn"},Se=["disabled","onClick"],Ie={__name:"ProductListing",setup(Te){const{t:_}=H(),T=d(document.documentElement.dir||"ltr"),L=d([]),$=d([]),g=d(!1),x=d(""),b=d([]),n=d({min:0,max:5e3}),v={min:0,max:5e3},p=d(!1),f=O(),w=()=>{p.value=!p.value;const e=document.querySelector(".sidebar"),a=document.body;e&&(e.classList.toggle("active",p.value),e.classList.contains("active")?a.classList.add("no-scroll"):a.classList.remove("no-scroll"))},A=e=>`https://backend.webenia.org/public/storage/${e}`,y=e=>f.favorites.some(a=>a.product_id===e),B=e=>{const a=f.favorites.find(i=>i.product_id===e);return a?a.id:null},M=async e=>{var a,i;try{const c=await V.post("https://backend.webenia.org/api/favorites",{product_id:e.id},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(y(e.id)){const s=B(e.id);s&&(await f.removeFromFavorites(s),x.value="Product removed from favorites")}else{const s=await f.addToFavorites(e.id);x.value=s.message}g.value=!0}catch(c){console.error("Favorite error:",c),Z({title:"⚠️",message:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Login required to favorite product",type:"error"})}},N=async()=>{try{const e=await V.get("https://backend.webenia.org/api/website");L.value=e.data.data||[]}catch(e){console.error("Error loading categories",e)}},U=async()=>{try{const e=await V.get("https://backend.webenia.org/api/all/products");$.value=e.data.data||[]}catch(e){console.error("Error loading products",e)}};j(()=>{N(),U()});const z=G(()=>$.value.filter(e=>{const a=b.value.length===0||b.value.includes(e.category_id),c=n.value.min===v.min&&n.value.max===v.max?!0:e.price>=n.value.min&&e.price<=n.value.max;return a&&c})),R=e=>{if(e.discount&&e.discount.length>0){const a=parseFloat(e.discount[0].discount_value),i=parseFloat(e.price);return(i-i*(a/100)).toFixed(2)}return e.price};return(e,a)=>{const i=D("fa"),c=D("router-link");return r(),l(F,null,[m(K),t("div",ee,[t("div",se,[t("div",te,[t("div",ae,[t("div",oe,[t("h1",ie,o(e.$t("products.title")),1)])])])])]),t("div",{class:"shop-container",dir:T.value},[t("div",re,[t("div",le,[t("a",{href:"#",onClick:J(w,["prevent"])},o(e.$t("products.filter")),1)]),t("aside",ce,[t("div",de,[t("button",{class:"close-btn",onClick:w},"×"),t("h3",ue,o(u(_)("products.categories")),1),a[6]||(a[6]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),(r(!0),l(F,null,E(L.value,s=>(r(),l("div",{key:s.id,class:"filter-item"},[t("label",ve,[I(o(e.$i18n.locale==="ar"?s.name_ar:s.name_en)+" ",1),P(t("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=C=>b.value=C),value:s.id},null,8,me),[[Q,b.value]]),a[5]||(a[5]=t("span",{class:"checkmark"},null,-1))])]))),128)),t("h3",_e,o(u(_)("products.price")),1),a[7]||(a[7]=t("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),t("div",ge,[P(t("input",{type:"range","onUpdate:modelValue":a[1]||(a[1]=s=>n.value.min=s),min:v.min,max:v.max},null,8,he),[[S,n.value.min,void 0,{number:!0}]]),P(t("input",{type:"range","onUpdate:modelValue":a[2]||(a[2]=s=>n.value.max=s),min:v.min,max:v.max},null,8,be),[[S,n.value.max,void 0,{number:!0}]]),t("div",pe,[t("span",null,o(n.value.min)+" - "+o(n.value.max)+" "+o(u(_)("AED")),1)])])])]),p.value?(r(),l("div",{key:0,class:"overlay",onClick:w})):h("",!0),t("section",fe,[(r(!0),l(F,null,E(z.value,s=>(r(),l("div",{key:s.id,class:"product-card"},[t("div",ye,[s.images&&s.images.length?(r(),l("img",{key:0,src:A(s.images[0].path),alt:s.name},null,8,ke)):h("",!0),s.is_available?h("",!0):(r(),l("div",xe,o(e.$t("products.outOfStock")),1)),t("div",we,[m(c,{to:`/read/products/${s.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:k(()=>[m(i,{icon:"eye"})]),_:2},1032,["to"]),t("button",{onClick:C=>M(s),class:W(["btn rounded-circle shadow-sm btn-light",y(s.id)?"text-danger":""]),title:y(s.id)?"Remove from favorites":"Add to favorites"},[m(i,{icon:y(s.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,Ce)])]),t("div",Fe,[t("h5",Pe,o(s.name_en),1),t("div",Ve,[s.discount&&s.discount.length>0?(r(),l("span",Le,o(s.discount[0].discount_value)+"% OFF ",1)):h("",!0),s.old_price?(r(),l("span",$e,o(s.old_price)+" "+o(s.currency.name_en),1)):h("",!0),t("span",De,o(R(s))+" "+o(s.currency.name_en),1)])]),t("div",Ee,[t("button",{disabled:!s.is_available,onClick:C=>e.addToCart(s),class:"btn"},o(e.$t("products.addToCart")),9,Se)])]))),128))])])],8,ne),m(u(Y),{modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=s=>g.value=s),title:u(_)("success"),width:"30%","before-close":()=>g.value=!1},{footer:k(()=>[m(u(X),{type:"primary",onClick:a[3]||(a[3]=s=>g.value=!1)},{default:k(()=>[I(o(u(_)("ok")),1)]),_:1})]),default:k(()=>[t("span",null,o(x.value),1)]),_:1},8,["modelValue","title","before-close"])],64)}}},Be=q(Ie,[["__scopeId","data-v-42e410bf"]]);export{Be as default};
