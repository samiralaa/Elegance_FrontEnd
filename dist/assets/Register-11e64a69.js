import{_ as q,Y as L,Z as U,b,r as _,o as d,c as m,a as t,t as a,w as C,h as c,j as y,n as p,g as f,p as v,e as D,q as P,F as V,d as E,k as F,f as k}from"./index-44f336bc.js";const R="https://backend.webenia.org/api",I={name:"Register",components:{ElSelect:L,ElOption:U},data(){return{formData:{fullName:"",email:"",password:"",confirmPassword:"",country_id:"",phoneNumber:""},countryCode:"",phoneNumber:"",errors:{fullName:"",email:"",password:"",confirmPassword:"",phoneNumber:"",country_id:""},countries:[],filteredCountries:[],loading:!1,showPassword:!1,showConfirmPassword:!1,countryCodes:{1:"93",2:"355",3:"213",4:"376",5:"244",6:"973",7:"880",8:"32",9:"55",10:"1",11:"86",12:"20",13:"33",14:"49",15:"30",16:"91",17:"62",18:"98",19:"964",20:"353",21:"39",22:"81",23:"962",24:"7",25:"254",26:"965",27:"961",28:"218",29:"60",30:"52",31:"212",32:"977",33:"31",34:"64",35:"234",36:"968",37:"92",38:"970",39:"974",40:"7",41:"966",42:"65",43:"27",44:"82",45:"34",46:"249",47:"46",48:"41",49:"963",50:"886",51:"255",52:"66",53:"216",54:"90",55:"256",56:"380",57:"971",58:"44",59:"1",60:"998",61:"84",62:"967",63:"263"}}},computed:{selectedCountryDialCode(){if(!Array.isArray(this.countries))return"";const e=this.countries.find(s=>s.id===this.formData.country_id);return e?this.getCountryCode(e.id):""},currentLocale(){var e;return((e=this.$i18n)==null?void 0:e.locale)||"en"}},created(){this.fetchCountries()},watch:{"formData.fullName"(e){this.validateFullName(e)},"formData.email"(e){this.validateEmail(e)},"formData.password"(e){this.validatePassword(e),this.formData.confirmPassword&&this.validateConfirmPassword(this.formData.confirmPassword)},"formData.confirmPassword"(e){this.validateConfirmPassword(e)},"formData.phoneNumber"(e){this.validatePhoneNumber(e)},"formData.country_id":{immediate:!0,handler(e){this.validateCountry(e),e?(this.countryCode=this.getCountryCode(e),this.phoneNumber&&this.updateFullPhoneNumber()):this.countryCode=""}},phoneNumber:{handler(e){this.updateFullPhoneNumber()}}},methods:{getCountryName(e){return this.currentLocale==="ar"?e.name_ar:e.name_en},getCountryCode(e){return this.countryCodes[e]||""},filterCountries(e){if(e){const s=e.toLowerCase();this.filteredCountries=this.countries.filter(n=>{var u,l;const h=((u=n.name_en)==null?void 0:u.toLowerCase())||"",r=((l=n.name_ar)==null?void 0:l.toLowerCase())||"",i=this.getCountryCode(n.id)||"";return h.includes(s)||r.includes(s)||i.includes(s)})}else this.filteredCountries=this.countries},async fetchCountries(){var e,s,n,h;try{this.loading=!0;const r=await b.get(`${R}/countries`);console.log("Countries API response:",r.data.data);const i=((e=r.data)==null?void 0:e.data)||[];this.countries=Array.isArray(i)?i:[],this.filteredCountries=this.countries,this.formData.country_id&&(this.countryCode=this.getCountryCode(this.formData.country_id),this.updateFullPhoneNumber())}catch(r){console.error("Error fetching countries:",r),(h=(s=this.$toast)==null?void 0:s.error)==null||h.call(s,((n=this.$t)==null?void 0:n.call(this,"register.errorFetchingCountries"))||"Failed to fetch countries")}finally{this.loading=!1}},validateFullName(e){e?e.length<3?this.errors.fullName=this.$t("register.validation.fullNameMinLength"):e.length>255?this.errors.fullName=this.$t("register.validation.fullNameMaxLength"):/^[\p{L}\s'-]+$/u.test(e)?this.errors.fullName="":this.errors.fullName=this.$t("register.validation.fullNameInvalid"):this.errors.fullName=this.$t("register.validation.fullNameRequired")},validateEmail(e){e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?this.errors.email="":this.errors.email=this.$t("register.validation.emailInvalid"):this.errors.email=this.$t("register.validation.emailRequired")},validatePassword(e){e?e.length<8?this.errors.password=this.$t("register.validation.passwordMinLength"):this.errors.password="":this.errors.password=this.$t("register.validation.passwordRequired")},validateConfirmPassword(e){e?e!==this.formData.password?this.errors.confirmPassword=this.$t("register.validation.confirmPasswordMatch"):this.errors.confirmPassword="":this.errors.confirmPassword=this.$t("register.validation.confirmPasswordRequired")},validatePhoneNumber(e){e?this.countryCode?e.length<10||e.length>18?this.errors.phoneNumber=this.$t("register.validation.phoneLength"):/^\d+$/.test(e)?this.errors.phoneNumber="":this.errors.phoneNumber=this.$t("register.validation.phoneInvalid"):this.errors.phoneNumber=this.$t("register.validation.countryRequired"):this.errors.phoneNumber=this.$t("register.validation.phoneRequired")},validateCountry(e){e?this.countries.some(s=>s.id===e)?this.errors.country_id="":this.errors.country_id=this.$t("register.validation.countryInvalid"):this.errors.country_id=this.$t("register.validation.countryRequired")},async handleRegister(){var e,s,n,h,r,i,u,l,g;if(this.validateFullName(this.formData.fullName),this.validateEmail(this.formData.email),this.validatePassword(this.formData.password),this.validateConfirmPassword(this.formData.confirmPassword),this.validatePhoneNumber(this.formData.phoneNumber),this.validateCountry(this.formData.country_id),!Object.values(this.errors).some(o=>o))try{const o=await b.post(`${R}/clients/register`,{name:this.formData.fullName,email:this.formData.email,password:this.formData.password,password_confirmation:this.formData.confirmPassword,country_id:this.formData.country_id,phone:this.formData.phoneNumber,role:"user"});if(o.data&&o.data.data)localStorage.setItem("user",JSON.stringify(o.data.data.user)),localStorage.setItem("auth_token",o.data.data.token),(s=(e=this.$toast)==null?void 0:e.success)==null||s.call(e,o.data.message||"Registration successful"),this.$router.push("/otp");else throw new Error("Invalid response format")}catch(o){if(console.error("Registration error:",o),(h=(n=o.response)==null?void 0:n.data)!=null&&h.errors){const w=o.response.data.errors;Object.keys(w).forEach(N=>{this.errors.hasOwnProperty(N)&&(this.errors[N]=w[N][0])})}else{const w=((i=(r=o.response)==null?void 0:r.data)==null?void 0:i.message)||((u=this.$t)==null?void 0:u.call(this,"register.error"))||"Registration failed";(g=(l=this.$toast)==null?void 0:l.error)==null||g.call(l,w)}}},updateFullPhoneNumber(){this.countryCode?this.formData.phoneNumber=this.countryCode+this.phoneNumber:this.formData.phoneNumber=this.phoneNumber},formatPhoneNumber(e){let s=e.target.value;s=s.replace(/\D/g,""),this.phoneNumber=s},togglePassword(){this.showPassword=!this.showPassword},toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword}}},j={class:"join-us-container"},A={class:"join-us-content"},M={class:"form-header"},S={class:"elegant-title"},O={class:"elegant-description"},B={class:"form-group"},H={for:"fullName"},T=["placeholder"],z={key:0,class:"error-message"},J={class:"form-group"},Q={for:"email"},Y=["placeholder"],Z={key:0,class:"error-message"},G={class:"form-group"},K={for:"password"},W={class:"password-input-container"},X=["type","placeholder"],x={key:0,class:"error-message"},$={class:"form-group"},ee={for:"confirmPassword"},re={class:"password-input-container"},se=["type","placeholder"],oe={key:0,class:"error-message"},te={class:"form-group"},ie={for:"country"},ae={class:"country-option"},ne={class:"country-name"},le={class:"country-code"},de={key:0,class:"error-message"},he={class:"form-group"},me={for:"phoneNumber"},ue={class:"phone-input-container"},ce={class:"country-code-input"},fe=["placeholder"],pe=["placeholder"],ge={key:0,class:"error-message"},we={type:"submit",class:"submit-btn"},ye={class:"register-section"};function Ne(e,s,n,h,r,i){const u=_("el-option"),l=_("el-select"),g=_("router-link");return d(),m("div",j,[s[14]||(s[14]=t("div",{class:"banner-section"},null,-1)),t("div",A,[t("div",M,[t("h1",S,a(e.$t("header.register")),1),t("p",O,a(e.$t("header.register")),1)]),t("form",{onSubmit:s[12]||(s[12]=C((...o)=>i.handleRegister&&i.handleRegister(...o),["prevent"])),class:"join-form"},[t("div",B,[t("label",H,a(e.$t("header.fullName")),1),c(t("input",{type:"text",id:"fullName","onUpdate:modelValue":s[0]||(s[0]=o=>r.formData.fullName=o),placeholder:e.$t("header.fullNamePlaceholder"),class:p({error:r.errors.fullName,valid:r.formData.fullName&&!r.errors.fullName}),required:""},null,10,T),[[y,r.formData.fullName]]),r.errors.fullName?(d(),m("span",z,a(r.errors.fullName),1)):f("",!0)]),t("div",J,[t("label",Q,a(e.$t("header.email")),1),c(t("input",{type:"email",id:"email","onUpdate:modelValue":s[1]||(s[1]=o=>r.formData.email=o),placeholder:e.$t("header.emailPlaceholder"),class:p({error:r.errors.email,valid:r.formData.email&&!r.errors.email}),required:""},null,10,Y),[[y,r.formData.email]]),r.errors.email?(d(),m("span",Z,a(r.errors.email),1)):f("",!0)]),t("div",G,[t("label",K,a(e.$t("header.password")),1),t("div",W,[c(t("input",{type:r.showPassword?"text":"password",id:"password","onUpdate:modelValue":s[2]||(s[2]=o=>r.formData.password=o),placeholder:e.$t("header.passwordPlaceholder"),class:p({error:r.errors.password,valid:r.formData.password&&!r.errors.password}),required:"",onCopy:s[3]||(s[3]=C(()=>{},["prevent"]))},null,42,X),[[v,r.formData.password]]),t("button",{type:"button",class:"show-password-btn",onClick:s[4]||(s[4]=(...o)=>i.togglePassword&&i.togglePassword(...o))},a(r.showPassword?e.$t("joinUs.hidePassword"):e.$t("joinUs.showPassword")),1)]),r.errors.password?(d(),m("span",x,a(r.errors.password),1)):f("",!0)]),t("div",$,[t("label",ee,a(e.$t("header.confirmPassword")),1),t("div",re,[c(t("input",{type:r.showConfirmPassword?"text":"password",id:"confirmPassword","onUpdate:modelValue":s[5]||(s[5]=o=>r.formData.confirmPassword=o),placeholder:e.$t("register.confirmPasswordPlaceholder"),class:p({error:r.errors.confirmPassword,valid:r.formData.confirmPassword&&!r.errors.confirmPassword}),required:"",onCopy:s[6]||(s[6]=C(()=>{},["prevent"]))},null,42,se),[[v,r.formData.confirmPassword]]),t("button",{type:"button",class:"show-password-btn",onClick:s[7]||(s[7]=(...o)=>i.toggleConfirmPassword&&i.toggleConfirmPassword(...o))},a(r.showConfirmPassword?e.$t("joinUs.hidePassword"):e.$t("joinUs.showPassword")),1)]),r.errors.confirmPassword?(d(),m("span",oe,a(r.errors.confirmPassword),1)):f("",!0)]),t("div",te,[t("label",ie,a(e.$t("register.country")),1),D(l,{modelValue:r.formData.country_id,"onUpdate:modelValue":s[8]||(s[8]=o=>r.formData.country_id=o),class:"country-select",placeholder:e.$t("register.countryPlaceholder"),loading:r.loading,filterable:"","filter-method":i.filterCountries,"remote-method":i.filterCountries,remote:!1,required:""},{default:P(()=>[(d(!0),m(V,null,E(r.filteredCountries,o=>(d(),F(u,{key:o.id,label:i.getCountryName(o),value:o.id},{default:P(()=>[t("div",ae,[t("span",ne,a(i.getCountryName(o)),1),t("span",le,"+"+a(i.getCountryCode(o.id)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","loading","filter-method","remote-method"]),r.errors.country_id?(d(),m("span",de,a(r.errors.country_id),1)):f("",!0)]),t("div",he,[t("label",me,a(e.$t("register.phoneNumber")),1),t("div",ue,[t("div",ce,[s[13]||(s[13]=t("span",{class:"plus"},"+",-1)),c(t("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=o=>r.countryCode=o),class:"country-code-field",readonly:"",placeholder:i.selectedCountryDialCode||"Code"},null,8,fe),[[y,r.countryCode]])]),c(t("input",{type:"tel",id:"phoneNumber","onUpdate:modelValue":s[10]||(s[10]=o=>r.phoneNumber=o),placeholder:e.$t("register.phoneNumberPlaceholder"),class:p({error:r.errors.phoneNumber,valid:r.phoneNumber&&!r.errors.phoneNumber}),required:"",minlength:"10",maxlength:"18",onInput:s[11]||(s[11]=(...o)=>i.formatPhoneNumber&&i.formatPhoneNumber(...o))},null,42,pe),[[y,r.phoneNumber]])]),r.errors.phoneNumber?(d(),m("span",ge,a(r.errors.phoneNumber),1)):f("",!0)]),t("button",we,a(e.$t("register.submit")),1),t("div",ye,[t("p",null,[k(a(e.$t("register.alreadyHaveAccount"))+" ",1),D(g,{to:"/account/login",class:"link"},{default:P(()=>[k(a(e.$t("register.loginHere")),1)]),_:1})])])],32)])])}const Ce=q(I,[["render",Ne],["__scopeId","data-v-5475f625"]]);export{Ce as default};
