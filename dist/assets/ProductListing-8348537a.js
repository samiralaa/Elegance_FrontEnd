import{_ as j,B as G,K as w,x as m,y as Q,C as W,N as M,r as N,o as d,c as u,e as g,a,t as c,g as X,D as C,F,d as U,w as f,v as h,l as S,f as $,b as E,H as Y,ae as Z,p as A,n as ee,k as te,E as v}from"./index-b9e1cd55.js";const se={class:"axil-breadcrumb-area mt-5"},ae={class:"container"},oe={class:"row align-items-center"},re={class:"col-lg-6 col-md-8"},ne={class:"inner"},ie={class:"title"},le=["dir"],ce={class:"container"},de={class:"filter col-12"},ue={class:"sidebar"},me={class:"sidebar-container"},ve={class:"sidebar-title"},_e={class:"checkbox-container"},pe=["value"],ge={class:"sidebar-title"},fe={class:"price-range"},be=["min","max"],ye=["min","max"],he={class:"price-values"},xe=["min","max"],ke=["min","max"],we={class:"products-grid"},Ce={class:"image-container mb-3 bg-light rounded"},Fe=["src","alt"],Se={key:0,class:"sale-badge"},$e={class:"product-actions d-flex justify-content-center gap-5 w-100"},Ee=["onClick","title"],Ie={class:"card-body"},Le={class:"card-title"},De={class:"price-container"},Pe={class:"card-text card-price"},Ve=["disabled","onClick"],Me={__name:"ProductListing",setup(Ne){const{locale:I,t:l}=G(),T=w(()=>I.value==="ar"?"rtl":"ltr"),L=m([]),D=m([]);m(!1),m("");const _=m([]),o=m({min:0,max:2e3}),i={min:0,max:2e3},p=m(!1),b=Q(),P=w(()=>{const t=localStorage.getItem("selectedCurrency");return t?JSON.parse(t).code:"AED"}),B=(t,s,n)=>{const r={AED:1,USD:.2724795640326976};return s===n?parseFloat(t):r[n]?parseFloat((t*r[n]).toFixed(2)):parseFloat(t)},x=()=>{p.value=!p.value;const t=document.querySelector(".sidebar"),s=document.body;t&&(t.classList.toggle("active",p.value),t.classList.contains("active")?s.classList.add("no-scroll"):s.classList.remove("no-scroll"))},q=t=>`https://backend.webenia.org/public/storage/${t}`,y=t=>b.favorites.some(s=>s.product_id===t),z=t=>{const s=b.favorites.find(n=>n.product_id===t);return s?s.favorite_id||s.id:null},K=async t=>{var s,n;try{if(y(t.id)){const r=z(t.id);r&&(await b.removeFromFavorites(r),v({title:l("success"),message:l("favorite_removed")||"Product removed from favorites",type:"success"}))}else{const r=await b.addToFavorites(t.id);v({title:l("success"),message:r.message||l("favorite_added")||"Product added to favorites",type:"success"})}}catch(r){console.error("Favorite error:",r),v({title:l("error"),message:((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||l("login_required_favorite")||"Login required to favorite product",type:"error"})}},O=async()=>{try{const t=await E.get("https://backend.webenia.org/api/website");L.value=t.data.data||[]}catch(t){console.error("Error loading categories",t)}},V=async()=>{try{const t=await E.get("https://backend.webenia.org/api/all/products");D.value=t.data.data||[]}catch(t){console.error("Error loading products",t)}},R=async t=>{var s,n;try{const r=JSON.parse(localStorage.getItem("selectedCurrency"))||{code:"USD"},e=await E.post("https://backend.webenia.org/api/cart-items",{product_id:t.id,quantity:1,price:parseFloat(t.price)},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Currency:r.code}});e.data.status?v({title:l("success"),message:e.data.message,type:"success"}):v({title:l("error"),message:e.data.message,type:"error"})}catch(r){console.error("Error adding to cart:",r),v({title:l("error"),message:(n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message,type:"error"})}};W(()=>{O(),V(),window.addEventListener("currency-changed",()=>{V(),J()})});const H=w(()=>D.value.filter(t=>{const s=_.value.length===0||_.value.includes(t.category_id),n=o.value.min===i.min&&o.value.max===i.max,r=B(t.converted_price,t.currency_code||"AED",P.value),e=n?!0:r>=o.value.min&&r<=o.value.max;return s&&e})),J=()=>{_.value=[],o.value.min=i.min,o.value.max=i.max,p.value=!1,document.body.classList.remove("no-scroll")};return M(()=>o.value.min,t=>{t>o.value.max&&(o.value.min=o.value.max)}),M(()=>o.value.max,t=>{t<o.value.min&&(o.value.max=o.value.min)}),(t,s)=>{const n=N("router-link"),r=N("fa");return d(),u(F,null,[g(Y),a("div",se,[a("div",ae,[a("div",oe,[a("div",re,[a("div",ne,[a("h1",ie,c(t.$t("products.title")),1)])])])])]),a("div",{class:"shop-container",dir:T.value},[a("div",ce,[a("div",de,[a("a",{href:"#",onClick:X(x,["prevent"])},c(t.$t("products.filter")),1)]),a("aside",ue,[a("div",me,[a("button",{class:"close-btn",onClick:x},"Ã—"),a("h3",ve,c(C(l)("products.categories")),1),s[11]||(s[11]=a("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),(d(!0),u(F,null,U(L.value,e=>(d(),u("div",{key:e.id,class:"filter-item"},[a("label",_e,[S(c(t.$i18n.locale==="ar"?e.name_ar:e.name_en)+" ",1),f(a("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=k=>_.value=k),value:e.id},null,8,pe),[[Z,_.value]]),s[9]||(s[9]=a("span",{class:"checkmark"},null,-1))])]))),128)),a("h3",ge,c(C(l)("products.price")),1),s[12]||(s[12]=a("hr",{style:{color:"#8b6b3d",opacity:"1","border-top":"3px solid"}},null,-1)),a("div",fe,[f(a("input",{type:"range","onUpdate:modelValue":s[1]||(s[1]=e=>o.value.min=e),step:"10",min:i.min,max:i.max},null,8,be),[[h,o.value.min,void 0,{number:!0}]]),f(a("input",{type:"range","onUpdate:modelValue":s[2]||(s[2]=e=>o.value.max=e),step:"10",min:i.min,max:i.max},null,8,ye),[[h,o.value.max,void 0,{number:!0}]]),a("div",he,[a("span",null,[f(a("input",{type:"number","onUpdate:modelValue":s[3]||(s[3]=e=>o.value.min=e),step:10,min:i.min,max:i.max,onInput:s[4]||(s[4]=e=>o.value.min=Math.floor(Math.min(o.value.min,2e3))),onKeydown:s[5]||(s[5]=e=>["e","E",".","+","-"].includes(e.key)&&e.preventDefault())},null,40,xe),[[h,o.value.min,void 0,{number:!0}]]),s[10]||(s[10]=S(" - ")),f(a("input",{type:"number","onUpdate:modelValue":s[6]||(s[6]=e=>o.value.max=e),step:10,min:i.min,max:i.max,onInput:s[7]||(s[7]=e=>o.value.max=Math.floor(Math.min(o.value.max,2e3))),onKeydown:s[8]||(s[8]=e=>["e","E",".","+","-"].includes(e.key)&&e.preventDefault())},null,40,ke),[[h,o.value.max,void 0,{number:!0}]]),S(" "+c(P.value.value),1)])])])])]),p.value?(d(),u("div",{key:0,class:"overlay",onClick:x})):$("",!0),a("section",we,[(d(!0),u(F,null,U(H.value,e=>(d(),u("div",{key:e.id,class:"product-card"},[a("div",Ce,[g(n,{to:`/read/products/${e.id}`},{default:A(()=>[e.images&&e.images.length?(d(),u("img",{key:0,src:q(e.images[0].path),alt:e.name},null,8,Fe)):$("",!0)]),_:2},1032,["to"]),e.is_available?$("",!0):(d(),u("div",Se,c(t.$t("products.outOfStock")),1)),a("div",$e,[g(n,{to:`/read/products/${e.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:A(()=>[g(r,{icon:"eye"})]),_:2},1032,["to"]),a("button",{onClick:k=>K(e),class:ee(["btn rounded-circle shadow-sm btn-light",y(e.id)?"text-danger":""]),title:y(e.id)?"Remove from favorites":"Add to favorites"},[g(r,{icon:y(e.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,Ee)])]),a("div",Ie,[a("h5",Le,c(C(I)==="ar"?e.name_ar:e.name_en),1),a("div",De,[a("span",Pe,c(e.converted_price)+" "+c(e.currency_code),1)])]),a("div",{class:"addToCart-btn",style:te(e.is_available?"":"cursor: not-allowed;")},[a("button",{disabled:!e.is_available,onClick:k=>R(e),class:"btn"},c(t.$t("products.addToCart")),9,Ve)],4)]))),128))])])],8,le)],64)}}},Ae=j(Me,[["__scopeId","data-v-7b5fcf82"]]);export{Ae as default};
