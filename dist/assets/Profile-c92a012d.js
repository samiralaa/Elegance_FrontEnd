import{_ as F,H as w,b as f,r as g,o as i,c as a,e as _,a as e,t as l,l as h,F as v,d as A,f as c,g as D,w as m,v as p}from"./index-3c0db741.js";const C={components:{Header:w},data(){return{loading:!0,error:null,user:{},showAddressDialog:!1,editingAddressId:null,addressForm:{building_name:"",floor_number:"",apartment_number:"",postal_code:"",landmark:"",city_id:"",country_id:""},addressSuccess:!1}},methods:{formatDate(r){return r?new Date(r).toLocaleDateString():"N/A"},goToResetPassword(){this.$router.push({name:"ResetPassword",query:{email:this.user.email}})},formatAddress(r){let s="";return r.country?s=this.$i18n&&this.$i18n.locale==="ar"?r.country.name_ar:r.country.name_en:r.country_id&&(s=r.country_id),[r.building_name,r.floor_number,r.apartment_number,r.postal_code,r.landmark,r.city_id,s].filter(Boolean).join(", ")},openEditDialog(r){this.editingAddressId=r.id,this.addressForm={...r},this.showAddressDialog=!0},closeEditDialog(){this.showAddressDialog=!1,this.editingAddressId=null,this.addressForm={building_name:"",floor_number:"",apartment_number:"",postal_code:"",landmark:"",city_id:"",country_id:""}},async saveAddress(r){var s,u;try{const n=await f.post(`api/address/${r}`,this.addressForm,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),o=this.user.address.findIndex(d=>d.id===r);o!==-1&&n.data&&n.data.data&&this.$set(this.user.address,o,n.data.data),this.addressSuccess=!0,this.$toast&&this.$toast.success(n.data.message||"Address updated successfully!"),setTimeout(()=>{this.addressSuccess=!1,this.closeEditDialog()},1200)}catch(n){const o=((u=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:u.message)||"Failed to update address";this.$toast&&this.$toast.error(o)}}},async created(){var r,s;try{const u=await f.get("api/me",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});this.user=u.data.data.user}catch(u){this.error=((s=(r=u.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch profile"}finally{this.loading=!1}}},N={class:"profile-outer"},I={key:0,class:"profile-loading"},V={key:1,class:"profile-error"},B={key:2,class:"profile-card"},E={class:"profile-header"},S={class:"avatar"},P={class:"user-info"},U={class:"user-role"},T={class:"profile-details"},H={class:"detail-row"},x={class:"detail-row"},L={class:"detail-row"},M={key:0,class:"address-block"},R={class:"detail-row"},z=["onClick"],j={key:0,class:"modal-overlay"},q={class:"modal-content"},G={class:"form-group"},J={class:"form-group"},K={class:"form-group"},O={class:"form-group"},Q={class:"form-group"},W={class:"form-group"},X={class:"form-group"},Y={class:"modal-actions"},Z={key:0,class:"success-message"};function $(r,s,u,n,o,d){const y=g("Header"),b=g("fa");return i(),a(v,null,[_(y),e("div",N,[o.loading?(i(),a("div",I,[s[10]||(s[10]=e("span",{class:"loader"},null,-1)),e("span",null,l(r.$t("profile.loading")),1)])):o.error?(i(),a("div",V,[e("span",null,l(o.error),1)])):(i(),a("div",B,[e("div",E,[e("div",S,[e("span",null,l(o.user.name?o.user.name.charAt(0).toUpperCase():"?"),1)]),e("div",P,[e("h1",null,l(o.user.name),1),e("span",U,l(o.user.role),1)]),e("button",{class:"reset-password-btn",onClick:s[0]||(s[0]=(...t)=>d.goToResetPassword&&d.goToResetPassword(...t))},[s[11]||(s[11]=e("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24"},[e("path",{d:"M12 15v2m0 0v2m0-2h2m-2 0H10m8-6a8 8 0 11-16 0 8 8 0 0116 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),h(" "+l(r.$t("profile.resetPassword")),1)])]),e("div",T,[e("div",H,[e("span",null,l(r.$t("profile.name")),1),e("span",null,l(o.user.name),1)]),e("div",x,[e("span",null,l(r.$t("profile.email")),1),e("span",null,l(o.user.email),1)]),e("div",L,[e("span",null,l(r.$t("profile.phone")),1),e("span",null,l(o.user.phone),1)]),o.user.address&&o.user.address.length?(i(),a("div",M,[e("h3",null,l(r.$t("profile.address")),1),(i(!0),a(v,null,A(o.user.address,(t,k)=>(i(),a("div",{key:t.id||k,class:"address-details",style:{"margin-bottom":"0.5em"}},[e("div",R,[e("span",null,l(d.formatAddress(t)),1),e("button",{class:"edit-btn",onClick:ss=>d.openEditDialog(t)},"Edit",8,z)])]))),128))])):c("",!0)])]))]),o.showAddressDialog?(i(),a("div",j,[e("div",q,[s[21]||(s[21]=e("h3",null,"Edit Address",-1)),e("form",{onSubmit:s[9]||(s[9]=D(t=>d.saveAddress(o.editingAddressId),["prevent"]))},[e("div",G,[s[12]||(s[12]=e("label",null,"Building Name",-1)),m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.addressForm.building_name=t),placeholder:"Building Name"},null,512),[[p,o.addressForm.building_name]])]),e("div",J,[s[13]||(s[13]=e("label",null,"Floor Number",-1)),m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>o.addressForm.floor_number=t),placeholder:"Floor Number"},null,512),[[p,o.addressForm.floor_number]])]),e("div",K,[s[14]||(s[14]=e("label",null,"Apartment Number",-1)),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>o.addressForm.apartment_number=t),placeholder:"Apartment Number"},null,512),[[p,o.addressForm.apartment_number]])]),e("div",O,[s[15]||(s[15]=e("label",null,"Postal Code",-1)),m(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>o.addressForm.postal_code=t),placeholder:"Postal Code"},null,512),[[p,o.addressForm.postal_code]])]),e("div",Q,[s[16]||(s[16]=e("label",null,"Landmark",-1)),m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>o.addressForm.landmark=t),placeholder:"Landmark"},null,512),[[p,o.addressForm.landmark]])]),e("div",W,[s[17]||(s[17]=e("label",null,"City ID",-1)),m(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>o.addressForm.city_id=t),placeholder:"City ID"},null,512),[[p,o.addressForm.city_id]])]),e("div",X,[s[18]||(s[18]=e("label",null,"Country ID",-1)),m(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>o.addressForm.country_id=t),placeholder:"Country ID"},null,512),[[p,o.addressForm.country_id]])]),e("div",Y,[s[19]||(s[19]=e("button",{type:"submit",class:"btn-primary"},"Save",-1)),e("button",{type:"button",class:"btn-secondary",onClick:s[8]||(s[8]=(...t)=>d.closeEditDialog&&d.closeEditDialog(...t))},"Cancel")]),o.addressSuccess?(i(),a("div",Z,[_(b,{icon:"check-circle",style:{color:"#28a745","margin-right":"6px"}}),s[20]||(s[20]=h(" Address updated successfully! "))])):c("",!0)],32)])])):c("",!0)],64)}const os=F(C,[["render",$],["__scopeId","data-v-111d199d"]]);export{os as default};
